<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Linux åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</title>
<style>
body { 
  font-family: "Microsoft YaHei", Arial, sans-serif; 
  background: #f5f5f5; 
  margin: 0;
  padding: 0;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
  color: white;
  padding: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  position: sticky;
  top: 0;
  z-index: 1000;
}

.header h1 {
  margin: 0 0 15px 0;
  font-size: 2.2em;
}

.header .subtitle {
  font-size: 1.1em;
  opacity: 0.9;
}

.main-container {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.content-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.sidebar {
  width: 350px;
  background: #fff;
  border-left: 1px solid #e0e0e0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.sidebar-header {
  padding: 15px;
  background: #f8f9fa;
  border-bottom: 1px solid #e0e0e0;
}

.alert-container {
  flex: 1;
  overflow-y: auto;
  padding: 15px;
}

.alert { 
  padding: 15px; 
  margin-bottom: 10px; 
  border-radius: 5px;
}

.alert-high { 
  background: #ffebee; 
  color: #c62828; 
  border-left: 5px solid #c62828; 
}

.alert-medium { 
  background: #fff3e0; 
  color: #ef6c00; 
  border-left: 5px solid #ef6c00; 
}

.alert-low { 
  background: #e3f2fd; 
  color: #1565c0; 
  border-left: 5px solid #1565c0; 
}

.alert-link { 
  cursor: pointer; 
  color: inherit; 
  text-decoration: underline; 
}

.alert-count { 
  background: #fff; 
  padding: 2px 8px; 
  border-radius: 10px; 
  margin-left: 10px; 
  font-size: 12px; 
}

.search-container {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 10px 0;
}

#searchInput {
  flex: 1;
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 3px;
  min-width: 200px;
}

.search-nav {
  display: flex;
  align-items: center;
  gap: 10px;
  white-space: nowrap;
}

.search-nav button {
  padding: 8px 15px;
  background: #2196F3;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
}

.search-nav button:hover {
  background: #1976D2;
}

.search-nav button:disabled {
  background: #ccc;
  cursor: not-allowed;
}

.tabs {
  overflow: hidden;
  background: #333;
  border-radius: 5px;
  margin-bottom: 10px;
  display: flex;
  flex-wrap: wrap;
}

.tabs button {
  background: #333;
  color: #fff;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 14px;
  flex: 1;
  min-width: 120px;
}

.tabs button:hover {
  background: #ddd;
  color: black;
}

.tabs button.active {
  background: #2196F3;
  color: white;
}

.tabcontent {
  display: none;
  padding: 20px;
  background: #fff;
  border-radius: 5px;
  margin-top: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.tabcontent pre {
  background: #222;
  color: #eee;
  padding: 15px;
  border-radius: 5px;
  overflow-x: auto;
  margin: 0;
  font-size: 14px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.tabcontent details {
  margin-bottom: 15px;
  border: 1px solid #e0e0e0;
  border-radius: 5px;
}

.tabcontent summary {
  cursor: pointer;
  font-weight: bold;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 5px 5px 0 0;
  border-bottom: 1px solid #e0e0e0;
  transition: background 0.3s;
}

.tabcontent summary:hover {
  background: #e9ecef;
}

.tabcontent details[open] summary {
  background: #007bff;
  color: white;
}

.mark {
  background: yellow;
  color: red;
  font-weight: bold;
}

.mark.current {
  background: #ff4444;
  color: white;
}

#fileInput {
  margin: 10px 0;
}

.alert-summary {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.alert-badge {
  padding: 8px 15px;
  border-radius: 20px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: bold;
}

.alert-badge.high {
  background: #ffebee;
  color: #c62828;
}

.alert-badge.medium {
  background: #fff3e0;
  color: #ef6c00;
}

.alert-badge.low {
  background: #e3f2fd;
  color: #1565c0;
}

.alert-badge .count {
  background: rgba(255,255,255,0.8);
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 12px;
}

.collapse-button {
  padding: 5px 10px;
  background: none;
  border: 1px solid #ccc;
  border-radius: 3px;
  cursor: pointer;
  margin-left: auto;
}

.collapse-button:hover {
  background: #f0f0f0;
}

/* ç»Ÿè®¡é¢æ¿æ ·å¼ */
.stats-panel {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.stat-item {
  background: rgba(255,255,255,0.1);
  padding: 15px;
  border-radius: 8px;
  text-align: center;
  backdrop-filter: blur(10px);
}

.stat-number {
  font-size: 2em;
  font-weight: bold;
  margin-bottom: 5px;
}

.stat-label {
  font-size: 0.9em;
  opacity: 0.9;
}

.risk-level {
  display: inline-block;
  padding: 5px 15px;
  border-radius: 20px;
  font-weight: bold;
  margin: 10px 0;
}

.risk-high { background: #ff4757; color: white; }
.risk-medium { background: #ffa502; color: white; }
.risk-low { background: #3742fa; color: white; }
.risk-normal { background: #2ed573; color: white; }

/* å»ºè®®é¢æ¿æ ·å¼ */
.recommendations-panel {
  background: #f8f9fa;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 20px;
  border-left: 5px solid #28a745;
}

.recommendation-item {
  background: white;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
  border-left: 4px solid #007bff;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.recommendation-level {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: bold;
  margin-right: 10px;
}

.level-high { background: #ff4757; color: white; }
.level-medium { background: #ffa502; color: white; }
.level-low { background: #3742fa; color: white; }
.level-info { background: #2ed573; color: white; }

@keyframes highlight-pulse {
  0% { background: #ff4444; }
  50% { background: #ff8888; }
  100% { background: #ff4444; }
}

/* æ•™ç¨‹æ ·å¼ */
.tutorial-content {
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  line-height: 1.6;
}

.tutorial-section {
  margin-bottom: 30px;
  padding: 20px;
  border: 1px solid #e1e8ed;
  border-radius: 8px;
  background: #f8f9fa;
}

.tutorial-section h4 {
  color: #2c3e50;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #3498db;
}

.step-by-step .step {
  margin-bottom: 25px;
  padding: 15px;
  background: white;
  border-radius: 6px;
  border-left: 4px solid #3498db;
}

.command-block {
  background: #2c3e50;
  color: #ecf0f1;
  padding: 15px;
  border-radius: 6px;
  font-family: 'Courier New', monospace;
  margin: 10px 0;
  overflow-x: auto;
}

.command-block code {
  color: #2ecc71;
  font-weight: bold;
}

.tip {
  background: #e8f5e8;
  border: 1px solid #27ae60;
  border-radius: 6px;
  padding: 10px;
  margin-top: 10px;
  color: #27ae60;
}

.warning-box {
  background: #fdf2e9;
  border: 1px solid #e67e22;
  border-radius: 6px;
  padding: 15px;
  color: #d35400;
}

.tool-list .tool-item {
  background: white;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 6px;
  border-left: 4px solid #9b59b6;
}

.process-flow .process-step {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 20px;
  margin-bottom: 8px;
  border-radius: 25px;
  font-weight: bold;
}

.attack-patterns .pattern-item {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 6px;
  border-left: 4px solid #e74c3c;
}

.detection-methods .method-item {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 6px;
  border-left: 4px solid #f39c12;
}

.response-actions .action-item {
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 6px;
}

.action-item.urgent {
  background: #ffebee;
  border-left: 4px solid #f44336;
}

.action-item.medium {
  background: #fff8e1;
  border-left: 4px solid #ff9800;
}

.action-item.low {
  background: #e8f5e8;
  border-left: 4px solid #4caf50;
}

.hardening-tips .tip-category {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 6px;
  border-left: 4px solid #2196f3;
}

.suspicious-signs h5 {
  margin-top: 15px;
  margin-bottom: 10px;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .main-container {
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    max-height: 300px;
  }
  
  .tabs {
    flex-direction: column;
  }
  
  .tabs button {
    flex: none;
  }
  
  .stats-grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  }
}

</style>
<script>
const TAB_TITLES = {
  summary: "ğŸ“Š ç»Ÿè®¡åˆ†ææ€»è§ˆ",
  backdoor: "ğŸ” ç³»ç»Ÿåé—¨æ’æŸ¥",
  user: "ğŸ‘¥ ç”¨æˆ·ä¸ç™»å½•æ£€æŸ¥",
  log: "ğŸ“‹ æ—¥å¿—åˆ†æ",
  network: "ğŸŒ ç½‘ç»œæ£€æŸ¥",
  process: "âš™ï¸ è¿›ç¨‹æ£€æŸ¥",
  filesystem: "ğŸ“ æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥",
  package: "ğŸ“¦ è½¯ä»¶åŒ…æ£€æŸ¥",
  persistence: "ğŸ”„ æŒä¹…åŒ–æ£€æŸ¥",
  integrity: "ğŸ›¡ï¸ ç³»ç»Ÿå®Œæ•´æ€§",
  malware: "ğŸ¦  æ¶æ„è¿›ç¨‹ä¸ææƒç‚¹"
};

const SUB_TAB_TITLES = {
  summary: ["ç³»ç»Ÿæ¦‚è§ˆ", "é£é™©è¯„ä¼°", "æ™ºèƒ½å»ºè®®", "æ£€æŸ¥æ¸…å•", "ä¸“ä¸šæ€»ç»“"],
  backdoor: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "UIDä¸º0çš„érootç”¨æˆ·", "å¯ç–‘ç³»ç»Ÿé…ç½®", "å¼‚å¸¸ç³»ç»Ÿæ–‡ä»¶"],
  user: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å½“å‰ç”¨æˆ·", "æ‰€æœ‰ç”¨æˆ·", "æœ€è¿‘ç™»å½•è®°å½•", "ç™»å½•å¤±è´¥è®°å½•"],
  log: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "SSHæ”»å‡»ç»Ÿè®¡åˆ†æ", "ç™»å½•ä¼šè¯åˆ†æ", "ç³»ç»Ÿæ—¥å¿—é”™è¯¯", "æ•°æ®ä¼ è¾“å¼‚å¸¸åˆ†æ", "æ”»å‡»æ¨¡å¼è¯†åˆ«", "IPåœ°ç†ä½ç½®åˆ†æ", "å®‰å…¨äº‹ä»¶æ—¶é—´çº¿"],
  network: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "ç›‘å¬ç«¯å£", "æ´»åŠ¨è¿æ¥", "ç½‘ç»œé…ç½®", "è·¯ç”±è¡¨", "å¯ç–‘è¿æ¥"],
  process: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "é«˜CPUå ç”¨è¿›ç¨‹", "å¯ç–‘è„šæœ¬è¿›ç¨‹"],
  filesystem: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "SUIDæ–‡ä»¶", "æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶"],
  package: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å·²å®‰è£…çš„è½¯ä»¶åŒ…"],
  persistence: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "è‡ªå¯åŠ¨æœåŠ¡", "è®¡åˆ’ä»»åŠ¡", "SSHå…¬é’¥", "å¯åŠ¨é¡¹é…ç½®"],
  integrity: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å…³é”®äºŒè¿›åˆ¶æ–‡ä»¶æ ¡éªŒ", "ç³»ç»Ÿæ–‡ä»¶å®Œæ•´æ€§"],
  malware: ["ğŸ“š æ’æŸ¥æ•™ç¨‹", "å¯ç–‘è¿›ç¨‹", "å¯ç–‘ææƒç‚¹", "éšè—æ–‡ä»¶"]
};

let gTabs = Object.keys(TAB_TITLES);
let gContent = "";
let currentSearchIndex = -1;
let searchResults = [];
let analysisData = null;

// å‘Šè­¦ç»“æœå­˜å‚¨
let alertResults = {
  high: [],
  medium: [],
  low: []
};

// ç»Ÿè®¡æ•°æ®å­˜å‚¨
let systemStats = {
  total_users: 0,
  uid0_users: 0,
  listening_ports: 0,
  suspicious_processes: 0,
  suid_files: 0,
  recent_files: 0,
  failed_logins: 0,
  cron_jobs: 0,
  risk_score: 0,
  risk_level: 'NORMAL'
};

function parseTextReport(text) {
  const sections = text.split("##########################################");
  const data = {};
  let currentSection = null;
  
  for (const section of sections) {
    if (!section.trim()) continue;
    
    const moduleMatch = section.match(/æ¨¡å—: (.*?)\n/);
    if (!moduleMatch) continue;
    
    const moduleTitle = moduleMatch[1];
    const moduleKey = Object.keys(TAB_TITLES).find(key => TAB_TITLES[key].includes(moduleTitle) || TAB_TITLES[key] === moduleTitle);
    if (!moduleKey) continue;
    
    const subSections = section.split("------------------------------------------");
    data[moduleKey] = {};
    
    for (let i = 1; i < subSections.length; i += 2) {
      const titleMatch = subSections[i].match(/å­é¡¹: (.*?)\n/);
      if (!titleMatch) continue;
      const title = titleMatch[1];
      const content = subSections[i + 1] ? subSections[i + 1].trim() : "";
      data[moduleKey][title] = content;
    }
  }
  
  return data;
}

// ç”Ÿæˆç»Ÿè®¡åˆ†æ
function generateStatistics(data) {
  const stats = {
    system_overview: {},
    security_summary: {},
    risk_assessment: {},
    recommendations: []
  };
  
  // é‡ç½®ç»Ÿè®¡æ•°æ®
  systemStats = {
    total_users: 0,
    uid0_users: 0,
    listening_ports: 0,
    suspicious_processes: 0,
    suid_files: 0,
    recent_files: 0,
    failed_logins: 0,
    cron_jobs: 0,
    risk_score: 0,
    risk_level: 'NORMAL'
  };
  
  // ç”¨æˆ·ç»Ÿè®¡
  if (data.user && data.user['æ‰€æœ‰ç”¨æˆ·']) {
    const users = data.user['æ‰€æœ‰ç”¨æˆ·'].split('\n').filter(u => u.trim());
    systemStats.total_users = users.length;
  }
  
  if (data.backdoor && data.backdoor['UIDä¸º0çš„érootç”¨æˆ·']) {
    const uid0Content = data.backdoor['UIDä¸º0çš„érootç”¨æˆ·'];
    systemStats.uid0_users = (uid0Content.match(/å¯ç–‘UID 0ç”¨æˆ·/g) || []).length;
  }
  
  // ç½‘ç»œç»Ÿè®¡
  if (data.network && data.network['ç›‘å¬ç«¯å£']) {
    const ports = data.network['ç›‘å¬ç«¯å£'];
    systemStats.listening_ports = (ports.match(/LISTEN|:/g) || []).length;
  }
  
  // è¿›ç¨‹ç»Ÿè®¡
  if (data.process && data.process['å¯ç–‘è„šæœ¬è¿›ç¨‹']) {
    const processes = data.process['å¯ç–‘è„šæœ¬è¿›ç¨‹'].split('\n').filter(p => p.trim());
    systemStats.suspicious_processes = processes.length;
  }
  
  // æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡
  if (data.filesystem && data.filesystem['SUIDæ–‡ä»¶']) {
    const suidFiles = data.filesystem['SUIDæ–‡ä»¶'];
    systemStats.suid_files = (suidFiles.match(/-rws/g) || []).length;
  }
  
  if (data.filesystem && data.filesystem['æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶']) {
    const recentFiles = data.filesystem['æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶'].split('\n').filter(f => f.trim());
    systemStats.recent_files = recentFiles.length;
  }
  
  // ç™»å½•å¤±è´¥ç»Ÿè®¡
  if (data.user && data.user['ç™»å½•å¤±è´¥è®°å½•']) {
    const failedLogins = data.user['ç™»å½•å¤±è´¥è®°å½•'];
    systemStats.failed_logins = (failedLogins.match(/Failed password/g) || []).length;
  }
  
  // è®¡åˆ’ä»»åŠ¡ç»Ÿè®¡
  if (data.persistence && data.persistence['è®¡åˆ’ä»»åŠ¡']) {
    const cronJobs = data.persistence['è®¡åˆ’ä»»åŠ¡'];
    systemStats.cron_jobs = (cronJobs.match(/crontab|cron|\*/g) || []).length;
  }
  
  // é£é™©è¯„åˆ†è®¡ç®—
  let riskScore = 0;
  const recommendations = [];
  
  if (systemStats.uid0_users > 0) {
    riskScore += 50;
    recommendations.push({
      level: 'high',
      title: 'å‘ç°å¼‚å¸¸é«˜æƒé™ç”¨æˆ·',
      description: `å‘ç° ${systemStats.uid0_users} ä¸ªérootçš„UIDä¸º0ç”¨æˆ·ï¼Œè¿™å¯èƒ½æ˜¯å®‰å…¨å¨èƒã€‚`,
      action: 'å»ºè®®ç«‹å³ä¸è¿ç»´å’Œå¼€å‘äººå‘˜ç¡®è®¤è¿™äº›ç”¨æˆ·çš„åˆæ³•æ€§ï¼Œå¦‚æ— æ³•ç¡®è®¤åº”ç«‹å³ç¦ç”¨ã€‚'
    });
  } else {
    recommendations.push({
      level: 'info',
      title: 'ç”¨æˆ·æƒé™æ£€æŸ¥æ­£å¸¸',
      description: `ç³»ç»Ÿå…±æœ‰ ${systemStats.total_users} ä¸ªç”¨æˆ·è´¦æˆ·ï¼Œé™¤rootå¤–æœªå‘ç°å…¶ä»–UIDä¸º0çš„é«˜æƒé™ç”¨æˆ·ï¼Œè¿™æ˜¯è‰¯å¥½çš„å®‰å…¨å®è·µã€‚`,
      action: 'å»ºè®®å®šæœŸå®¡æŸ¥ç”¨æˆ·è´¦æˆ·ï¼Œç¡®ä¿æƒé™åˆ†é…åˆç†ã€‚'
    });
  }

  // å¢å¼ºçš„ç”¨æˆ·åˆ†æ
  if (systemStats.total_users === 0) {
    recommendations.push({
      level: 'warning',
      title: 'ç”¨æˆ·ä¿¡æ¯è·å–å¼‚å¸¸',
      description: 'æœªèƒ½è·å–åˆ°ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯æƒé™ä¸è¶³æˆ–ç³»ç»Ÿå¼‚å¸¸ã€‚',
      action: 'å»ºè®®æ£€æŸ¥è„šæœ¬æ‰§è¡Œæƒé™ï¼Œç¡®ä¿ä»¥rootæƒé™è¿è¡Œï¼Œæˆ–æ£€æŸ¥/etc/passwdæ–‡ä»¶æ˜¯å¦å¯è¯»ã€‚'
    });
  } else if (systemStats.total_users < 5) {
    recommendations.push({
      level: 'info',
      title: 'ç³»ç»Ÿç”¨æˆ·æ•°é‡è¾ƒå°‘',
      description: `ç³»ç»Ÿä»…æœ‰ ${systemStats.total_users} ä¸ªç”¨æˆ·è´¦æˆ·ï¼Œè¿™é€šå¸¸è¡¨æ˜æ˜¯ä¸€ä¸ªç²¾ç®€çš„ç”Ÿäº§ç³»ç»Ÿã€‚`,
      action: 'å»ºè®®ç¡®è®¤æ‰€æœ‰ç”¨æˆ·è´¦æˆ·éƒ½æ˜¯å¿…éœ€çš„ï¼Œå®šæœŸæ¸…ç†ä¸æ´»è·ƒçš„è´¦æˆ·ã€‚'
    });
  } else if (systemStats.total_users > 20) {
    recommendations.push({
      level: 'medium',
      title: 'ç³»ç»Ÿç”¨æˆ·æ•°é‡è¾ƒå¤š',
      description: `ç³»ç»Ÿæœ‰ ${systemStats.total_users} ä¸ªç”¨æˆ·è´¦æˆ·ï¼Œç”¨æˆ·æ•°é‡è¾ƒå¤šå¯èƒ½å¢åŠ å®‰å…¨é£é™©ã€‚`,
      action: 'å»ºè®®ä¸è¿ç»´å›¢é˜Ÿç¡®è®¤æ‰€æœ‰ç”¨æˆ·çš„å¿…è¦æ€§ï¼Œç¦ç”¨æˆ–åˆ é™¤ä¸æ´»è·ƒçš„è´¦æˆ·ï¼Œå®æ–½æœ€å°æƒé™åŸåˆ™ã€‚'
    });
  }
  
  // ç½‘ç»œç«¯å£åˆ†æ
  if (systemStats.listening_ports === 0) {
    recommendations.push({
      level: 'warning',
      title: 'æœªæ£€æµ‹åˆ°ç›‘å¬ç«¯å£',
      description: 'ç³»ç»Ÿæœªæ£€æµ‹åˆ°ä»»ä½•ç›‘å¬ç«¯å£ï¼Œè¿™å¯èƒ½è¡¨æ˜ç½‘ç»œæœåŠ¡æœªå¯åŠ¨æˆ–æ£€æµ‹å¼‚å¸¸ã€‚',
      action: 'å»ºè®®æ£€æŸ¥ç½‘ç»œæœåŠ¡çŠ¶æ€ï¼Œç¡®è®¤æ˜¯å¦ä¸ºé¢„æœŸé…ç½®ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨ï¼Œé€šå¸¸åº”è¯¥æœ‰ä¸€äº›å¿…è¦çš„æœåŠ¡ç«¯å£ã€‚'
    });
  } else if (systemStats.listening_ports > 20) {
    riskScore += 20;
    recommendations.push({
      level: 'medium',
      title: 'ç›‘å¬ç«¯å£æ•°é‡è¾ƒå¤š',
      description: `ç³»ç»Ÿç›‘å¬äº† ${systemStats.listening_ports} ä¸ªç«¯å£ï¼Œç«¯å£æ•°é‡è¾ƒå¤šå¯èƒ½å¢åŠ æ”»å‡»é¢ã€‚`,
      action: 'å»ºè®®ä¸è¿ç»´å›¢é˜Ÿé€ä¸€ç¡®è®¤æ¯ä¸ªç›‘å¬ç«¯å£çš„å¿…è¦æ€§ï¼Œå…³é—­ä¸å¿…è¦çš„æœåŠ¡ï¼Œå‡å°‘æ½œåœ¨çš„æ”»å‡»å…¥å£ã€‚'
    });
  } else if (systemStats.listening_ports > 0 && systemStats.listening_ports <= 5) {
    recommendations.push({
      level: 'info',
      title: 'ç½‘ç»œæœåŠ¡é…ç½®åˆç†',
      description: `ç³»ç»Ÿç›‘å¬ ${systemStats.listening_ports} ä¸ªç«¯å£ï¼Œæ•°é‡é€‚ä¸­ï¼Œç¬¦åˆå®‰å…¨æœ€ä½³å®è·µã€‚`,
      action: 'å»ºè®®å®šæœŸå®¡æŸ¥ç›‘å¬æœåŠ¡ï¼Œç¡®ä¿æ‰€æœ‰æœåŠ¡éƒ½æ˜¯ä¸šåŠ¡å¿…éœ€çš„ã€‚'
    });
  }

  // SUIDæ–‡ä»¶åˆ†æ
  if (systemStats.suid_files === 0) {
    recommendations.push({
      level: 'warning',
      title: 'SUIDæ–‡ä»¶æ£€æµ‹å¼‚å¸¸',
      description: 'æœªæ£€æµ‹åˆ°ä»»ä½•SUIDæ–‡ä»¶ï¼Œè¿™å¯èƒ½è¡¨æ˜æ£€æµ‹å¼‚å¸¸ï¼Œæ­£å¸¸ç³»ç»Ÿåº”è¯¥æœ‰ä¸€äº›ç³»ç»ŸSUIDæ–‡ä»¶ã€‚',
      action: 'å»ºè®®æ£€æŸ¥findå‘½ä»¤æ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼Œæˆ–è€…ç³»ç»Ÿæ˜¯å¦ä¸ºå®¹å™¨ç¯å¢ƒã€‚'
    });
  } else if (systemStats.suid_files > 100) {
    riskScore += 25;
    recommendations.push({
      level: 'high',
      title: 'SUIDæ–‡ä»¶æ•°é‡å¼‚å¸¸',
      description: `å‘ç° ${systemStats.suid_files} ä¸ªSUIDæ–‡ä»¶ï¼Œæ•°é‡å¼‚å¸¸åå¤šï¼Œå¯èƒ½å­˜åœ¨ææƒé£é™©ã€‚`,
      action: 'å»ºè®®ç«‹å³æ£€æŸ¥SUIDæ–‡ä»¶åˆ—è¡¨ï¼Œç‰¹åˆ«å…³æ³¨/tmpã€/var/tmpç­‰ä¸´æ—¶ç›®å½•ä¸­çš„SUIDæ–‡ä»¶ï¼Œä¸è¿ç»´å›¢é˜Ÿç¡®è®¤å¼‚å¸¸æ–‡ä»¶çš„æ¥æºã€‚'
    });
  } else if (systemStats.suid_files > 50) {
    riskScore += 10;
    recommendations.push({
      level: 'medium',
      title: 'SUIDæ–‡ä»¶éœ€è¦å…³æ³¨',
      description: `å‘ç° ${systemStats.suid_files} ä¸ªSUIDæ–‡ä»¶ï¼Œæ•°é‡åå¤šï¼Œå»ºè®®å®¡æŸ¥ã€‚`,
      action: 'å»ºè®®æ£€æŸ¥SUIDæ–‡ä»¶åˆ—è¡¨ï¼Œç¡®è®¤æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ç³»ç»Ÿå¿…éœ€çš„ï¼Œç§»é™¤ä¸å¿…è¦çš„SUIDæƒé™ã€‚'
    });
  }

  // ç™»å½•å¤±è´¥åˆ†æ
  if (systemStats.failed_logins > 100) {
    riskScore += 40;
    recommendations.push({
      level: 'high',
      title: 'æ£€æµ‹åˆ°å¤§é‡ç™»å½•å¤±è´¥',
      description: `å‘ç° ${systemStats.failed_logins} æ¬¡ç™»å½•å¤±è´¥ï¼Œå¯èƒ½æ­£åœ¨é­å—æš´åŠ›ç ´è§£æ”»å‡»ã€‚`,
      action: 'å»ºè®®ç«‹å³æ£€æŸ¥ç™»å½•æ—¥å¿—ï¼Œè¯†åˆ«æ”»å‡»æºIPï¼Œè€ƒè™‘å®æ–½IPå°ç¦ã€ä¿®æ”¹SSHç«¯å£ã€å¯ç”¨fail2banç­‰é˜²æŠ¤æªæ–½ã€‚'
    });
  } else if (systemStats.failed_logins > 20) {
    riskScore += 15;
    recommendations.push({
      level: 'medium',
      title: 'ç™»å½•å¤±è´¥æ¬¡æ•°è¾ƒå¤š',
      description: `å‘ç° ${systemStats.failed_logins} æ¬¡ç™»å½•å¤±è´¥ï¼Œéœ€è¦å…³æ³¨æ½œåœ¨çš„å®‰å…¨å¨èƒã€‚`,
      action: 'å»ºè®®æ£€æŸ¥ç™»å½•æ—¥å¿—ï¼Œåˆ†æå¤±è´¥åŸå› ï¼Œå¦‚æœæ˜¯å¤–éƒ¨æ”»å‡»åº”åŠ å¼ºè®¿é—®æ§åˆ¶ã€‚'
    });
  } else if (systemStats.failed_logins === 0) {
    recommendations.push({
      level: 'info',
      title: 'ç™»å½•å®‰å…¨çŠ¶å†µè‰¯å¥½',
      description: 'æœªå‘ç°ç™»å½•å¤±è´¥è®°å½•ï¼Œç³»ç»Ÿç™»å½•å®‰å…¨çŠ¶å†µè‰¯å¥½ã€‚',
      action: 'å»ºè®®ä¿æŒå½“å‰çš„å®‰å…¨é…ç½®ï¼Œå®šæœŸç›‘æ§ç™»å½•æ—¥å¿—ã€‚'
    });
  }

  if (systemStats.suspicious_processes > 10) {
    riskScore += 30;
    recommendations.push({
      level: 'medium',
      title: 'å¯ç–‘è¿›ç¨‹æ•°é‡å¼‚å¸¸',
      description: `å‘ç° ${systemStats.suspicious_processes} ä¸ªå¯ç–‘è„šæœ¬è¿›ç¨‹ï¼Œæ•°é‡è¾ƒå¤šã€‚`,
      action: 'å»ºè®®æ£€æŸ¥è¿™äº›è¿›ç¨‹çš„åˆæ³•æ€§ï¼Œç¡®è®¤å…¶ä¸šåŠ¡å¿…è¦æ€§ã€‚'
    });
  } else if (systemStats.suspicious_processes > 0) {
    recommendations.push({
      level: 'low',
      title: 'å‘ç°å°‘é‡å¯ç–‘è¿›ç¨‹',
      description: `å‘ç° ${systemStats.suspicious_processes} ä¸ªå¯ç–‘è„šæœ¬è¿›ç¨‹ã€‚`,
      action: 'å»ºè®®ç¡®è®¤è¿™äº›è¿›ç¨‹çš„ä¸šåŠ¡å¿…è¦æ€§ã€‚'
    });
  }
  
  if (systemStats.suid_files > 100) {
    riskScore += 20;
    recommendations.push({
      level: 'medium',
      title: 'SUIDæ–‡ä»¶æ•°é‡å¼‚å¸¸',
      description: `å‘ç° ${systemStats.suid_files} ä¸ªSUIDæ–‡ä»¶ï¼Œæ•°é‡è¾ƒå¤šã€‚`,
      action: 'å»ºè®®å®¡æŸ¥SUIDæ–‡ä»¶åˆ—è¡¨ï¼Œç¡®è®¤æ˜¯å¦å­˜åœ¨å¼‚å¸¸çš„ææƒæ–‡ä»¶ã€‚'
    });
  }
  
  if (systemStats.failed_logins > 50) {
    riskScore += 25;
    recommendations.push({
      level: 'medium',
      title: 'ç™»å½•å¤±è´¥æ¬¡æ•°å¼‚å¸¸',
      description: `ç™»å½•å¤±è´¥æ¬¡æ•°(${systemStats.failed_logins})è¾ƒå¤šï¼Œå¯èƒ½å­˜åœ¨æš´åŠ›ç ´è§£æ”»å‡»ã€‚`,
      action: 'å»ºè®®æ£€æŸ¥ç™»å½•æ—¥å¿—ï¼ŒåŠ å¼ºå¯†ç ç­–ç•¥å’Œè®¿é—®æ§åˆ¶ã€‚'
    });
  }
  
  if (systemStats.listening_ports > 20) {
    riskScore += 15;
    recommendations.push({
      level: 'low',
      title: 'ç›‘å¬ç«¯å£æ•°é‡è¾ƒå¤š',
      description: `ç›‘å¬ç«¯å£æ•°é‡(${systemStats.listening_ports})è¾ƒå¤šã€‚`,
      action: 'å»ºè®®å…³é—­ä¸å¿…è¦çš„æœåŠ¡ä»¥å‡å°‘æ”»å‡»é¢ã€‚'
    });
  }
  
  // ç¡®å®šé£é™©ç­‰çº§
  if (riskScore >= 80) {
    systemStats.risk_level = 'HIGH';
  } else if (riskScore >= 50) {
    systemStats.risk_level = 'MEDIUM';
  } else if (riskScore >= 20) {
    systemStats.risk_level = 'LOW';
  } else {
    systemStats.risk_level = 'NORMAL';
  }
  
  systemStats.risk_score = riskScore;
  
  return {
    statistics: systemStats,
    recommendations: recommendations
  };
}

// ç”Ÿæˆç»Ÿè®¡æ€»è§ˆå†…å®¹
function generateSummaryContent(data) {
  const analysis = generateStatistics(data);
  const stats = analysis.statistics;
  const recommendations = analysis.recommendations;
  
  const summaryData = {
    'ç³»ç»Ÿæ¦‚è§ˆ': `
=== ç³»ç»ŸåŸºæœ¬ä¿¡æ¯ ===
æ£€æŸ¥æ—¶é—´: ${new Date().toLocaleString()}
æ€»ç”¨æˆ·æ•°: ${stats.total_users}
UIDä¸º0çš„érootç”¨æˆ·: ${stats.uid0_users}
ç›‘å¬ç«¯å£æ•°: ${stats.listening_ports}
å¯ç–‘è¿›ç¨‹æ•°: ${stats.suspicious_processes}
SUIDæ–‡ä»¶æ•°: ${stats.suid_files}
æœ€è¿‘ä¿®æ”¹æ–‡ä»¶æ•°: ${stats.recent_files}
ç™»å½•å¤±è´¥æ¬¡æ•°: ${stats.failed_logins}
è®¡åˆ’ä»»åŠ¡æ•°: ${stats.cron_jobs}

=== é£é™©è¯„ä¼° ===
é£é™©è¯„åˆ†: ${stats.risk_score}
é£é™©ç­‰çº§: ${stats.risk_level}
    `,
    
    'é£é™©è¯„ä¼°': `
=== é£é™©ç­‰çº§è¯´æ˜ ===
NORMAL (0-19åˆ†): ç³»ç»Ÿå®‰å…¨çŠ¶å†µè‰¯å¥½
LOW (20-49åˆ†): å­˜åœ¨è½»å¾®å®‰å…¨é£é™©
MEDIUM (50-79åˆ†): å­˜åœ¨ä¸­ç­‰å®‰å…¨é£é™©ï¼Œéœ€è¦å…³æ³¨
HIGH (80+åˆ†): å­˜åœ¨ä¸¥é‡å®‰å…¨é£é™©ï¼Œéœ€è¦ç«‹å³å¤„ç†

=== å½“å‰é£é™©åˆ†æ ===
æ€»è¯„åˆ†: ${stats.risk_score} åˆ†
é£é™©ç­‰çº§: ${stats.risk_level}

è¯„åˆ†æ„æˆ:
- UIDä¸º0å¼‚å¸¸ç”¨æˆ·: ${stats.uid0_users > 0 ? '+50åˆ† (é«˜å±)' : '0åˆ† (æ­£å¸¸)'}
- å¯ç–‘è¿›ç¨‹è¿‡å¤š: ${stats.suspicious_processes > 10 ? '+30åˆ† (ä¸­å±)' : stats.suspicious_processes > 0 ? '+10åˆ† (ä½å±)' : '0åˆ† (æ­£å¸¸)'}
- SUIDæ–‡ä»¶å¼‚å¸¸: ${stats.suid_files > 100 ? '+20åˆ† (ä¸­å±)' : '0åˆ† (æ­£å¸¸)'}
- ç™»å½•å¤±è´¥è¿‡å¤š: ${stats.failed_logins > 50 ? '+25åˆ† (ä¸­å±)' : '0åˆ† (æ­£å¸¸)'}
- ç›‘å¬ç«¯å£è¿‡å¤š: ${stats.listening_ports > 20 ? '+15åˆ† (ä½å±)' : '0åˆ† (æ­£å¸¸)'}
    `,
    
    'æ™ºèƒ½å»ºè®®': recommendations.map(rec => 
      `[${rec.level.toUpperCase()}] ${rec.title}\n${rec.description}\nå¤„ç½®å»ºè®®: ${rec.action}`
    ).join('\n\n'),
    
    'æ£€æŸ¥æ¸…å•': generateProfessionalSummary(data, stats),
    
    'ä¸“ä¸šæ€»ç»“': generateIncidentResponseSummary(data, stats)
  };
  
  return summaryData;
}

// ç”Ÿæˆä¸“ä¸šæ£€æŸ¥æ¸…å•
function generateProfessionalSummary(data, stats) {
  return `
=== åº”æ€¥å“åº”æ£€æŸ¥æ¸…å• (åŸºäºNIST SP 800-61æ¡†æ¶) ===

ã€å‡†å¤‡é˜¶æ®µ - Preparationã€‘
â–¡ 1. ç¡®è®¤åº”æ€¥å“åº”å›¢é˜Ÿè”ç³»æ–¹å¼å’ŒèŒè´£åˆ†å·¥
â–¡ 2. éªŒè¯å¤‡ä»½ç³»ç»Ÿå’Œæ¢å¤ç¨‹åºçš„å¯ç”¨æ€§
â–¡ 3. ç¡®ä¿æ—¥å¿—è®°å½•å’Œç›‘æ§ç³»ç»Ÿæ­£å¸¸è¿è¡Œ

ã€æ£€æµ‹ä¸åˆ†æé˜¶æ®µ - Detection & Analysisã€‘
â–¡ 4. ç¡®è®¤æ‰€æœ‰UIDä¸º0çš„ç”¨æˆ·åˆæ³•æ€§ ${stats.uid0_users > 0 ? 'âš ï¸ å‘ç°å¼‚å¸¸' : 'âœ… æ­£å¸¸'}
â–¡ 5. åˆ†æå¯ç–‘è¿›ç¨‹çš„ä¸šåŠ¡å¿…è¦æ€§ ${stats.suspicious_processes > 10 ? 'âš ï¸ æ•°é‡å¼‚å¸¸' : 'âœ… æ­£å¸¸èŒƒå›´'}
â–¡ 6. å®¡æŸ¥SUIDæ–‡ä»¶æ˜¯å¦å­˜åœ¨å¼‚å¸¸ææƒç‚¹
â–¡ 7. åˆ†æç™»å½•å¤±è´¥æ—¥å¿—ï¼Œè¯†åˆ«æ½œåœ¨çš„æš´åŠ›ç ´è§£æ”»å‡» ${stats.failed_logins > 50 ? 'âš ï¸ å¤±è´¥æ¬¡æ•°è¿‡å¤š' : 'âœ… æ­£å¸¸'}
â–¡ 8. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œç›‘å¬ç«¯å£çš„åˆæ³•æ€§ ${stats.listening_ports > 20 ? 'âš ï¸ ç«¯å£è¾ƒå¤š' : 'âœ… æ­£å¸¸'}

ã€éåˆ¶é˜¶æ®µ - Containmentã€‘
â–¡ 9. éš”ç¦»å¯ç–‘ç³»ç»Ÿå’Œç½‘ç»œè¿æ¥
â–¡ 10. ä¿æŠ¤å…³é”®æ•°æ®å’Œç³»ç»Ÿèµ„æº
â–¡ 11. æ”¶é›†å’Œä¿å­˜æ•°å­—è¯æ®

ã€æ ¹é™¤é˜¶æ®µ - Eradicationã€‘
â–¡ 12. æ¸…é™¤æ¶æ„è½¯ä»¶å’Œåé—¨ç¨‹åº
â–¡ 13. ä¿®å¤ç³»ç»Ÿæ¼æ´å’Œå®‰å…¨é…ç½®
â–¡ 14. æ›´æ–°ç³»ç»Ÿè¡¥ä¸å’Œå®‰å…¨ç­–ç•¥

ã€æ¢å¤é˜¶æ®µ - Recoveryã€‘
â–¡ 15. éªŒè¯ç³»ç»Ÿå®Œæ•´æ€§å’ŒåŠŸèƒ½æ­£å¸¸
â–¡ 16. æ¢å¤ä¸šåŠ¡æœåŠ¡å’Œæ•°æ®è®¿é—®
â–¡ 17. åŠ å¼ºç›‘æ§å’Œæ—¥å¿—è®°å½•

ã€äº‹åæ´»åŠ¨ - Post-Incident Activityã€‘
â–¡ 18. ç¼–å†™è¯¦ç»†çš„äº‹ä»¶æŠ¥å‘Š
â–¡ 19. æ€»ç»“ç»éªŒæ•™è®­å’Œæ”¹è¿›å»ºè®®
â–¡ 20. æ›´æ–°åº”æ€¥å“åº”ç¨‹åºå’Œé¢„æ¡ˆ

=== ä¼˜å…ˆçº§å¤„ç†å»ºè®® ===
${stats.uid0_users > 0 ? 'ğŸ”´ ç´§æ€¥ (P0): ç«‹å³å¤„ç†UIDä¸º0å¼‚å¸¸ç”¨æˆ·ï¼Œå¯èƒ½å­˜åœ¨æƒé™æå‡å¨èƒ' : ''}
${stats.risk_score >= 80 ? 'ğŸ”´ é«˜å± (P1): ç³»ç»Ÿå­˜åœ¨ä¸¥é‡å®‰å…¨é£é™©ï¼Œéœ€è¦ç«‹å³å“åº”' : ''}
${stats.risk_score >= 50 && stats.risk_score < 80 ? 'ğŸŸ¡ ä¸­å± (P2): å­˜åœ¨å®‰å…¨éšæ‚£ï¼Œå»ºè®®24å°æ—¶å†…å¤„ç†' : ''}
${stats.risk_score >= 20 && stats.risk_score < 50 ? 'ğŸŸ¢ ä½å± (P3): ä¼˜åŒ–å®‰å…¨é…ç½®ï¼Œå»ºè®®72å°æ—¶å†…å¤„ç†' : ''}
${stats.risk_score < 20 ? 'âœ… æ­£å¸¸ (P4): ç³»ç»Ÿå®‰å…¨çŠ¶å†µè‰¯å¥½ï¼Œå»ºè®®å®šæœŸæ£€æŸ¥ç»´æŠ¤' : ''}
  `;
}

// ç”Ÿæˆä¸“ä¸šçš„äº‹ä»¶å“åº”æ€»ç»“
function generateIncidentResponseSummary(data, stats) {
  const currentTime = new Date().toLocaleString();
  
  // åˆ†æå·²ç¡®è®¤å®‰å…¨çš„é¡¹ç›®
  const secureItems = [];
  if (stats.uid0_users === 0) secureItems.push('ç”¨æˆ·æƒé™é…ç½®');
  if (stats.failed_logins < 10) secureItems.push('ç™»å½•å®‰å…¨çŠ¶å†µ');
  if (stats.suspicious_processes < 5) secureItems.push('è¿›ç¨‹è¿è¡ŒçŠ¶æ€');
  
  // éœ€è¦ä¸è¿ç»´ç¡®è®¤çš„é¡¹ç›®
  const confirmItems = [];
  if (stats.listening_ports > 10) confirmItems.push(`ç½‘ç»œæœåŠ¡é…ç½®(${stats.listening_ports}ä¸ªç›‘å¬ç«¯å£)`);
  if (stats.cron_jobs > 5) confirmItems.push(`è®¡åˆ’ä»»åŠ¡é…ç½®(${stats.cron_jobs}ä¸ªä»»åŠ¡)`);
  if (stats.suid_files > 50) confirmItems.push(`SUIDæ–‡ä»¶æƒé™(${stats.suid_files}ä¸ªæ–‡ä»¶)`);
  
  // å·²ç¡®è®¤å­˜åœ¨å¨èƒçš„é¡¹ç›®
  const threatItems = [];
  if (stats.uid0_users > 0) threatItems.push(`å¼‚å¸¸é«˜æƒé™ç”¨æˆ·(${stats.uid0_users}ä¸ª)`);
  if (stats.failed_logins > 50) threatItems.push(`æš´åŠ›ç ´è§£æ”»å‡»è¿¹è±¡(${stats.failed_logins}æ¬¡å¤±è´¥)`);
  
  // æœªå®Œæˆæ£€æŸ¥çš„é¡¹ç›®
  const pendingItems = [
    'æ·±åº¦æ¶æ„è½¯ä»¶æ‰«æ',
    'ç½‘ç»œæµé‡å¼‚å¸¸åˆ†æ',
    'æ–‡ä»¶å®Œæ•´æ€§æ·±åº¦æ ¡éªŒ',
    'å†…å­˜è½¬å‚¨åˆ†æ',
    'ç³»ç»Ÿè°ƒç”¨å®¡è®¡'
  ];
  
  return `
=== ç½‘ç»œå®‰å…¨äº‹ä»¶å“åº”æ€»ç»“æŠ¥å‘Š ===
æŠ¥å‘Šç”Ÿæˆæ—¶é—´: ${currentTime}
åˆ†æå¸ˆ: è‡ªåŠ¨åŒ–åº”æ€¥å“åº”ç³»ç»Ÿ
äº‹ä»¶ç­‰çº§: ${stats.risk_level} (è¯„åˆ†: ${stats.risk_score}/100)

ã€æ‰§è¡Œæ‘˜è¦ - Executive Summaryã€‘
æœ¬æ¬¡åº”æ€¥å“åº”æ£€æŸ¥åŸºäºNIST SP 800-61ç½‘ç»œå®‰å…¨äº‹ä»¶å¤„ç†æŒ‡å—æ‰§è¡Œï¼Œé‡‡ç”¨æ ‡å‡†åŒ–çš„æ£€æµ‹ã€åˆ†æã€éåˆ¶ã€æ ¹é™¤ã€æ¢å¤æµç¨‹ã€‚é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·å¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢çš„å®‰å…¨æ€åŠ¿è¯„ä¼°ã€‚

ã€å·²ç¡®è®¤å®‰å…¨çš„æ£€æŸ¥é¡¹ç›® - Verified Secure Itemsã€‘
${secureItems.length > 0 ? secureItems.map(item => `âœ… ${item}: ç»æ£€æŸ¥ç¡®è®¤ç¬¦åˆå®‰å…¨åŸºçº¿è¦æ±‚`).join('\n') : 'âš ï¸ æš‚æ— å®Œå…¨ç¡®è®¤å®‰å…¨çš„é¡¹ç›®ï¼Œå»ºè®®è¿›ä¸€æ­¥æ·±å…¥åˆ†æ'}

ã€éœ€è¦è¿ç»´ç¡®è®¤çš„ä¸šåŠ¡åˆè§„æ€§é¡¹ç›® - Items Requiring Operational Validationã€‘
${confirmItems.length > 0 ? confirmItems.map(item => `ğŸ” ${item}: å»ºè®®ä¸è¿ç»´å›¢é˜Ÿç¡®è®¤ä¸šåŠ¡åˆè§„æ€§å’Œå¿…è¦æ€§`).join('\n') : 'âœ… æ‰€æœ‰é…ç½®é¡¹ç›®å‡åœ¨æ­£å¸¸èŒƒå›´å†…'}

ã€å·²è¯†åˆ«çš„å®‰å…¨å¨èƒ - Confirmed Security Threatsã€‘
${threatItems.length > 0 ? threatItems.map(item => `ğŸš¨ ${item}: å·²ç¡®è®¤å­˜åœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®ç«‹å³é‡‡å–éåˆ¶æªæ–½`).join('\n') : 'âœ… æœªå‘ç°æ˜ç¡®çš„å®‰å…¨å¨èƒæŒ‡æ ‡'}

ã€å¾…æ·±å…¥æ£€æŸ¥çš„é¡¹ç›® - Pending Advanced Analysisã€‘
${pendingItems.map(item => `â³ ${item}: å»ºè®®ä½¿ç”¨ä¸“ä¸šå·¥å…·è¿›è¡Œæ·±åº¦åˆ†æ`).join('\n')}

ã€å»ºè®®åç»­è¡ŒåŠ¨ - Recommended Next Actionsã€‘
1. ã€ç«‹å³è¡ŒåŠ¨ã€‘é’ˆå¯¹å·²è¯†åˆ«å¨èƒæ‰§è¡Œéåˆ¶å’Œæ ¹é™¤æªæ–½
2. ã€24å°æ—¶å†…ã€‘ä¸è¿ç»´å›¢é˜Ÿç¡®è®¤å¯ç–‘é…ç½®çš„ä¸šåŠ¡åˆè§„æ€§
3. ã€72å°æ—¶å†…ã€‘æ‰§è¡Œæ·±åº¦å®‰å…¨æ‰«æå’Œå¨èƒç‹©çŒæ´»åŠ¨
4. ã€ä¸€å‘¨å†…ã€‘æ›´æ–°å®‰å…¨åŸºçº¿å’Œç›‘æ§è§„åˆ™
5. ã€æŒç»­ç›‘æ§ã€‘åŠ å¼ºæ—¥å¿—åˆ†æå’Œå¼‚å¸¸è¡Œä¸ºæ£€æµ‹

ã€åˆè§„æ€§å£°æ˜ - Compliance Statementã€‘
æœ¬æ¬¡æ£€æŸ¥éµå¾ªä»¥ä¸‹å®‰å…¨æ¡†æ¶å’Œæ ‡å‡†:
â€¢ NIST Cybersecurity Framework 2.0
â€¢ NIST SP 800-61 Rev.3 äº‹ä»¶å“åº”æŒ‡å—
â€¢ ISO/IEC 27035 ä¿¡æ¯å®‰å…¨äº‹ä»¶ç®¡ç†
â€¢ SANS äº‹ä»¶å“åº”å…­æ­¥æ³•

ã€å…è´£å£°æ˜ - Disclaimerã€‘
æœ¬æŠ¥å‘ŠåŸºäºè‡ªåŠ¨åŒ–å·¥å…·ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒã€‚å»ºè®®ç»“åˆäººå·¥åˆ†æå’Œä¸“ä¸šå®‰å…¨å›¢é˜Ÿçš„åˆ¤æ–­ï¼Œåˆ¶å®šæœ€ç»ˆçš„å®‰å…¨å“åº”ç­–ç•¥ã€‚å¯¹äºå…³é”®ä¸šåŠ¡ç³»ç»Ÿï¼Œå»ºè®®å’¨è¯¢ä¸“ä¸šçš„ç½‘ç»œå®‰å…¨æœåŠ¡æä¾›å•†ã€‚

---
æŠ¥å‘Šç¼–å·: IR-${Date.now()}
åˆ†ç±»çº§åˆ«: å†…éƒ¨ä½¿ç”¨
æœ‰æ•ˆæœŸé™: 30å¤©
  `;
}

// ç”Ÿæˆæ•™ç¨‹å†…å®¹
function generateTutorial(category) {
  const tutorials = {
    backdoor: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ›¡ï¸ ç³»ç»Ÿåé—¨æ’æŸ¥å®Œå…¨æŒ‡å—</h3>

<h4>ğŸ“– ä»€ä¹ˆæ˜¯ç³»ç»Ÿåé—¨ï¼Ÿ</h4>
<p>ç³»ç»Ÿåé—¨æ˜¯æ”»å‡»è€…åœ¨è·å¾—ç³»ç»Ÿè®¿é—®æƒé™åï¼Œä¸ºäº†ç»´æŒæŒä¹…åŒ–è®¿é—®è€Œæ¤å…¥çš„éšè”½é€šé“ã€‚åé—¨å¯ä»¥æ˜¯æ–‡ä»¶ã€è¿›ç¨‹ã€æœåŠ¡æˆ–ç³»ç»Ÿé…ç½®çš„ä¿®æ”¹ã€‚</p>

<h4>ğŸ” åé—¨æ’æŸ¥çš„æ ¸å¿ƒæ€è·¯</h4>
<ol>
<li><strong>æƒé™å¼‚å¸¸æ£€æŸ¥</strong> - æŸ¥æ‰¾ä¸åº”è¯¥å­˜åœ¨çš„é«˜æƒé™ç”¨æˆ·</li>
<li><strong>æ–‡ä»¶å®Œæ•´æ€§éªŒè¯</strong> - æ£€æŸ¥ç³»ç»Ÿå…³é”®æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹</li>
<li><strong>è¿›ç¨‹è¡Œä¸ºåˆ†æ</strong> - è¯†åˆ«å¯ç–‘çš„è¿è¡Œè¿›ç¨‹</li>
<li><strong>ç½‘ç»œè¿æ¥ç›‘æ§</strong> - å‘ç°å¼‚å¸¸çš„ç½‘ç»œé€šä¿¡</li>
<li><strong>å¯åŠ¨é¡¹æ£€æŸ¥</strong> - ç¡®è®¤è‡ªå¯åŠ¨ç¨‹åºçš„åˆæ³•æ€§</li>
</ol>

<h4>ğŸ’» å…³é”®æ’æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æ£€æŸ¥UIDä¸º0çš„ç”¨æˆ·ï¼ˆè¶…çº§ç”¨æˆ·æƒé™ï¼‰
awk -F: '$3==0 {print $1}' /etc/passwd

# 2. æŸ¥æ‰¾SUIDæ–‡ä»¶ï¼ˆå¯èƒ½çš„ææƒç‚¹ï¼‰
find / -perm -4000 -type f 2>/dev/null

# 3. æ£€æŸ¥æœ€è¿‘ä¿®æ”¹çš„ç³»ç»Ÿæ–‡ä»¶
find /bin /sbin /usr/bin /usr/sbin -mtime -7 -type f

# 4. æŸ¥çœ‹éšè—æ–‡ä»¶å’Œç›®å½•
find / -name ".*" -type f 2>/dev/null | grep -v proc | head -20

# 5. æ£€æŸ¥å¼‚å¸¸çš„ç½‘ç»œç›‘å¬
netstat -tulnp | grep LISTEN
</div>

<h4>ğŸš¨ å¸¸è§åé—¨ç‰¹å¾</h4>
<ul>
<li><strong>UIDä¸º0çš„érootç”¨æˆ·</strong> - é™¤äº†rootå¤–ä¸åº”è¯¥æœ‰å…¶ä»–UIDä¸º0çš„ç”¨æˆ·</li>
<li><strong>å¼‚å¸¸SUIDæ–‡ä»¶</strong> - ç‰¹åˆ«æ˜¯åœ¨/tmpã€/var/tmpç­‰ä¸´æ—¶ç›®å½•</li>
<li><strong>å¯ç–‘çš„éšè—æ–‡ä»¶</strong> - ä»¥ç‚¹å¼€å¤´çš„å¼‚å¸¸æ–‡ä»¶</li>
<li><strong>ä¿®æ”¹çš„ç³»ç»ŸäºŒè¿›åˆ¶æ–‡ä»¶</strong> - lsã€psã€netstatç­‰è¢«æ›¿æ¢</li>
<li><strong>å¼‚å¸¸çš„ç½‘ç»œç›‘å¬ç«¯å£</strong> - ä¸æ˜æ¥æºçš„ç›‘å¬æœåŠ¡</li>
</ul>

<h4>ğŸ”§ æ’æŸ¥æŠ€å·§ä¸ç»éªŒ</h4>
<ol>
<li><strong>å¯¹æ¯”åŸºçº¿</strong> - ä¸æ­£å¸¸ç³»ç»Ÿçš„é…ç½®è¿›è¡Œå¯¹æ¯”</li>
<li><strong>æ—¶é—´å…³è”</strong> - å…³æ³¨æ–‡ä»¶ä¿®æ”¹æ—¶é—´ä¸å…¥ä¾µæ—¶é—´çš„å…³è”</li>
<li><strong>è¿›ç¨‹çˆ¶å­å…³ç³»</strong> - ä½¿ç”¨pstreeæŸ¥çœ‹è¿›ç¨‹æ ‘ç»“æ„</li>
<li><strong>æ–‡ä»¶å“ˆå¸Œæ ¡éªŒ</strong> - å¯¹å…³é”®æ–‡ä»¶è¿›è¡ŒMD5/SHAæ ¡éªŒ</li>
<li><strong>æ—¥å¿—åˆ†æ</strong> - ç»“åˆç³»ç»Ÿæ—¥å¿—è¿›è¡Œç»¼åˆåˆ†æ</li>
</ol>

<h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ’æŸ¥è¿‡ç¨‹ä¸­é¿å…æƒŠåŠ¨æ”»å‡»è€…ï¼Œå…ˆæ”¶é›†è¯æ®å†å¤„ç½®</li>
<li>å¯¹å¯ç–‘æ–‡ä»¶è¿›è¡Œå¤‡ä»½ï¼Œä¾¿äºåç»­åˆ†æ</li>
<li>ä½¿ç”¨å¯ä¿¡çš„å¤–éƒ¨å·¥å…·è¿›è¡Œæ£€æŸ¥ï¼Œé¿å…ä½¿ç”¨è¢«ç¯¡æ”¹çš„ç³»ç»Ÿå‘½ä»¤</li>
<li>è®°å½•æ‰€æœ‰å‘ç°çš„å¼‚å¸¸ï¼Œå»ºç«‹å®Œæ•´çš„äº‹ä»¶æ—¶é—´çº¿</li>
</ul>
</div>
    `,
    
    user: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ‘¥ ç”¨æˆ·ä¸ç™»å½•å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç”¨æˆ·å®‰å…¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç”¨æˆ·è´¦æˆ·æ˜¯ç³»ç»Ÿå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿ã€‚æ”»å‡»è€…å¸¸å¸¸é€šè¿‡åˆ›å»ºåé—¨è´¦æˆ·ã€æå‡æƒé™æˆ–åˆ©ç”¨å¼±å¯†ç æ¥ç»´æŒç³»ç»Ÿè®¿é—®ã€‚</p>

<h4>ğŸ” ç”¨æˆ·æ£€æŸ¥çš„æ ¸å¿ƒè¦ç‚¹</h4>
<ol>
<li><strong>è´¦æˆ·åˆæ³•æ€§éªŒè¯</strong> - ç¡®è®¤æ‰€æœ‰ç”¨æˆ·è´¦æˆ·çš„åˆæ³•æ€§</li>
<li><strong>æƒé™ç­‰çº§å®¡æŸ¥</strong> - æ£€æŸ¥ç”¨æˆ·æƒé™æ˜¯å¦åˆç†</li>
<li><strong>ç™»å½•è¡Œä¸ºåˆ†æ</strong> - è¯†åˆ«å¼‚å¸¸çš„ç™»å½•æ¨¡å¼</li>
<li><strong>å¯†ç ç­–ç•¥æ£€æŸ¥</strong> - éªŒè¯å¯†ç å®‰å…¨ç­–ç•¥</li>
<li><strong>sudoæƒé™å®¡è®¡</strong> - æ£€æŸ¥ç‰¹æƒç”¨æˆ·é…ç½®</li>
</ol>

<h4>ğŸ’» å…³é”®æ£€æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·è´¦æˆ·
cat /etc/passwd | cut -d: -f1,3,4,5,6,7

# 2. æ£€æŸ¥æœ‰ç™»å½•æƒé™çš„ç”¨æˆ·
grep -v '/nologin\\|/false' /etc/passwd

# 3. æŸ¥çœ‹ç”¨æˆ·ç»„ä¿¡æ¯
cat /etc/group

# 4. æ£€æŸ¥sudoæƒé™é…ç½®
cat /etc/sudoers
visudo -c

# 5. æŸ¥çœ‹æœ€è¿‘ç™»å½•è®°å½•
last -20
lastlog

# 6. æ£€æŸ¥å½“å‰ç™»å½•ç”¨æˆ·
who -a
w

# 7. æŸ¥çœ‹ç”¨æˆ·å¯†ç ç­–ç•¥
chage -l username
</div>

<h4>ğŸš¨ å¼‚å¸¸ç”¨æˆ·ç‰¹å¾</h4>
<ul>
<li><strong>UIDä¸º0çš„érootç”¨æˆ·</strong> - å…·æœ‰è¶…çº§ç”¨æˆ·æƒé™çš„å¯ç–‘è´¦æˆ·</li>
<li><strong>æ— å®¶ç›®å½•çš„ç”¨æˆ·</strong> - å®¶ç›®å½•ä¸å­˜åœ¨æˆ–å¼‚å¸¸çš„ç”¨æˆ·</li>
<li><strong>å¼‚å¸¸shellçš„ç”¨æˆ·</strong> - ä½¿ç”¨éæ ‡å‡†shellçš„è´¦æˆ·</li>
<li><strong>æœ€è¿‘åˆ›å»ºçš„ç”¨æˆ·</strong> - å…¥ä¾µæ—¶é—´é™„è¿‘åˆ›å»ºçš„æ–°ç”¨æˆ·</li>
<li><strong>å¼‚å¸¸ç™»å½•æ—¶é—´</strong> - éå·¥ä½œæ—¶é—´çš„ç™»å½•æ´»åŠ¨</li>
</ul>

<h4>ğŸ”§ ç™»å½•å®‰å…¨åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>ç™»å½•é¢‘ç‡åˆ†æ</strong> - è¯†åˆ«å¼‚å¸¸é«˜é¢‘çš„ç™»å½•å°è¯•</li>
<li><strong>IPåœ°å€å…³è”</strong> - åˆ†æç™»å½•æ¥æºçš„åœ°ç†ä½ç½®</li>
<li><strong>å¤±è´¥ç™»å½•æ¨¡å¼</strong> - è¯†åˆ«æš´åŠ›ç ´è§£æ”»å‡»</li>
<li><strong>ä¼šè¯æŒç»­æ—¶é—´</strong> - åˆ†æå¼‚å¸¸é•¿æ—¶é—´çš„ä¼šè¯</li>
<li><strong>å¹¶å‘ç™»å½•æ£€æŸ¥</strong> - å‘ç°åŒä¸€ç”¨æˆ·çš„å¤šç‚¹ç™»å½•</li>
</ol>

<h4>âš ï¸ å®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸå®¡æŸ¥ç”¨æˆ·è´¦æˆ·ï¼Œåˆ é™¤ä¸å¿…è¦çš„è´¦æˆ·</li>
<li>å®æ–½å¼ºå¯†ç ç­–ç•¥å’Œå®šæœŸå¯†ç æ›´æ¢</li>
<li>å¯ç”¨ç™»å½•å¤±è´¥é”å®šæœºåˆ¶</li>
<li>ä½¿ç”¨SSHå¯†é’¥è®¤è¯æ›¿ä»£å¯†ç è®¤è¯</li>
<li>ç›‘æ§å’Œè®°å½•æ‰€æœ‰ç”¨æˆ·ç™»å½•æ´»åŠ¨</li>
</ul>
</div>
    `,
    
    log: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ“‹ æ—¥å¿—åˆ†æä¸æ”»å‡»æ£€æµ‹æŒ‡å—</h3>

<h4>ğŸ“– æ—¥å¿—åˆ†æçš„é‡è¦æ€§</h4>
<p>ç³»ç»Ÿæ—¥å¿—æ˜¯å®‰å…¨äº‹ä»¶çš„é‡è¦è¯æ®æ¥æºï¼Œé€šè¿‡ä¸“ä¸šçš„æ—¥å¿—åˆ†æå¯ä»¥å‘ç°æ”»å‡»ç—•è¿¹ã€é‡å»ºæ”»å‡»æ—¶é—´çº¿ï¼Œå¹¶è¯„ä¼°å®‰å…¨äº‹ä»¶çš„å½±å“èŒƒå›´ã€‚</p>

<h4>ğŸ” æ—¥å¿—åˆ†æçš„æ ¸å¿ƒæ–¹æ³•</h4>
<ol>
<li><strong>æ”»å‡»æ¨¡å¼è¯†åˆ«</strong> - è¯†åˆ«æš´åŠ›ç ´è§£ã€æ‰«æç­‰æ”»å‡»è¡Œä¸º</li>
<li><strong>æ—¶é—´çº¿é‡å»º</strong> - æ„å»ºå®Œæ•´çš„å®‰å…¨äº‹ä»¶æ—¶é—´çº¿</li>
<li><strong>IPä¿¡èª‰åˆ†æ</strong> - åˆ†ææ”»å‡»æ¥æºçš„å¨èƒæƒ…æŠ¥</li>
<li><strong>è¡Œä¸ºåŸºçº¿å¯¹æ¯”</strong> - ä¸æ­£å¸¸è¡Œä¸ºæ¨¡å¼è¿›è¡Œå¯¹æ¯”</li>
<li><strong>å…³è”åˆ†æ</strong> - å¤šç»´åº¦å…³è”åˆ†æå‘ç°éšè”½å¨èƒ</li>
</ol>

<h4>ğŸ’» æ—¥å¿—åˆ†æå…³é”®å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. SSHæš´åŠ›ç ´è§£æ£€æµ‹
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -nr

# 2. æˆåŠŸç™»å½•ç»Ÿè®¡
grep "Accepted password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c

# 3. å¼‚å¸¸æ—¶é—´ç™»å½•æ£€æµ‹
grep "Accepted" /var/log/auth.log | awk '$3 ~ /^(2[2-3]|0[0-6]):/ {print}'

# 4. ç”¨æˆ·æ‰«ææ£€æµ‹
grep "Invalid user" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -nr

# 5. æƒé™æå‡æ£€æµ‹
grep "sudo:" /var/log/auth.log | grep -v "session opened"

# 6. ç³»ç»Ÿé”™è¯¯åˆ†æ
grep -i "error\\|fail\\|denied" /var/log/syslog | tail -50

# 7. ç½‘ç»œè¿æ¥æ—¥å¿—
grep "Connection" /var/log/auth.log | tail -20
</div>

<h4>ğŸš¨ æ”»å‡»ç‰¹å¾è¯†åˆ«</h4>
<ul>
<li><strong>æš´åŠ›ç ´è§£æ”»å‡»</strong> - çŸ­æ—¶é—´å†…å¤§é‡å¤±è´¥ç™»å½•å°è¯•</li>
<li><strong>å­—å…¸æ”»å‡»</strong> - å°è¯•å¸¸è§ç”¨æˆ·åå¦‚adminã€testç­‰</li>
<li><strong>åˆ†å¸ƒå¼æ”»å‡»</strong> - æ¥è‡ªå¤šä¸ªIPçš„åè°ƒæ”»å‡»</li>
<li><strong>æ…¢é€Ÿæ”»å‡»</strong> - ä½é¢‘ç‡é•¿æ—¶é—´çš„æŒç»­æ”»å‡»</li>
<li><strong>æˆåŠŸå…¥ä¾µ</strong> - å¤±è´¥å°è¯•åçš„æˆåŠŸç™»å½•</li>
</ul>

<h4>ğŸ”§ é«˜çº§åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´çª—å£åˆ†æ</strong> - åˆ†æç‰¹å®šæ—¶é—´æ®µçš„æ´»åŠ¨æ¨¡å¼</li>
<li><strong>é¢‘ç‡ç»Ÿè®¡</strong> - è®¡ç®—æ”»å‡»é¢‘ç‡å’ŒæˆåŠŸç‡</li>
<li><strong>åœ°ç†ä½ç½®åˆ†æ</strong> - ç»“åˆIPåœ°ç†ä½ç½®ä¿¡æ¯</li>
<li><strong>ç”¨æˆ·è¡Œä¸ºç”»åƒ</strong> - å»ºç«‹æ­£å¸¸ç”¨æˆ·è¡Œä¸ºåŸºçº¿</li>
<li><strong>å¨èƒæƒ…æŠ¥å…³è”</strong> - ä¸å·²çŸ¥å¨èƒIPåº“è¿›è¡Œæ¯”å¯¹</li>
</ol>

<h4>ğŸ“Š æ—¥å¿—åˆ†ææœ€ä½³å®è·µ</h4>
<ul>
<li>å»ºç«‹æ—¥å¿—æ”¶é›†å’Œé›†ä¸­åŒ–ç®¡ç†æœºåˆ¶</li>
<li>è®¾ç½®å®æ—¶å‘Šè­¦è§„åˆ™ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸</li>
<li>å®šæœŸè¿›è¡Œæ—¥å¿—åˆ†æå’Œå®‰å…¨å®¡è®¡</li>
<li>ä¿ç•™è¶³å¤Ÿé•¿çš„æ—¥å¿—å†å²è®°å½•</li>
<li>ä½¿ç”¨ä¸“ä¸šçš„æ—¥å¿—åˆ†æå·¥å…·æé«˜æ•ˆç‡</li>
</ul>

<h4>âš ï¸ åˆ†ææ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ³¨æ„æ—¥å¿—çš„å®Œæ•´æ€§ï¼Œé˜²æ­¢è¢«æ”»å‡»è€…æ¸…é™¤</li>
<li>ç»“åˆå¤šä¸ªæ—¥å¿—æºè¿›è¡Œäº¤å‰éªŒè¯</li>
<li>å…³æ³¨æ—¥å¿—ä¸­çš„æ—¶é—´æˆ³å¼‚å¸¸</li>
<li>ä¿æŠ¤æ—¥å¿—æ–‡ä»¶çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§</li>
</ul>
</div>
    `,
    
    network: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸŒ ç½‘ç»œå®‰å…¨æ£€æŸ¥ä¸åˆ†ææŒ‡å—</h3>

<h4>ğŸ“– ç½‘ç»œå®‰å…¨æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç½‘ç»œæ˜¯æ”»å‡»è€…è¿›å…¥ç³»ç»Ÿå’Œæ•°æ®å¤–æ³„çš„ä¸»è¦é€šé“ã€‚é€šè¿‡ç½‘ç»œæ£€æŸ¥å¯ä»¥å‘ç°åé—¨è¿æ¥ã€å¼‚å¸¸é€šä¿¡å’Œæ½œåœ¨çš„æ•°æ®æ³„éœ²è¡Œä¸ºã€‚</p>

<h4>ğŸ” ç½‘ç»œæ£€æŸ¥çš„æ ¸å¿ƒè¦ç‚¹</h4>
<ol>
<li><strong>ç«¯å£ç›‘å¬åˆ†æ</strong> - è¯†åˆ«å¼‚å¸¸çš„ç›‘å¬æœåŠ¡</li>
<li><strong>è¿æ¥çŠ¶æ€æ£€æŸ¥</strong> - åˆ†ææ´»è·ƒçš„ç½‘ç»œè¿æ¥</li>
<li><strong>æµé‡æ¨¡å¼åˆ†æ</strong> - å‘ç°å¼‚å¸¸çš„æ•°æ®ä¼ è¾“</li>
<li><strong>é˜²ç«å¢™è§„åˆ™å®¡è®¡</strong> - æ£€æŸ¥å®‰å…¨ç­–ç•¥é…ç½®</li>
<li><strong>DNSè§£ææ£€æŸ¥</strong> - å‘ç°æ¶æ„åŸŸåè§£æ</li>
</ol>

<h4>ğŸ’» ç½‘ç»œæ£€æŸ¥å…³é”®å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æŸ¥çœ‹ç›‘å¬ç«¯å£å’ŒæœåŠ¡
ss -tulnp
netstat -tulnp

# 2. æŸ¥çœ‹æ´»è·ƒè¿æ¥
ss -antp
netstat -antp

# 3. æ£€æŸ¥ç½‘ç»œæ¥å£é…ç½®
ip addr show
ifconfig -a

# 4. æŸ¥çœ‹è·¯ç”±è¡¨
ip route
route -n

# 5. æ£€æŸ¥ARPè¡¨
arp -a
ip neigh

# 6. æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™
iptables -L -n
ufw status

# 7. æ£€æŸ¥ç½‘ç»œç»Ÿè®¡
ss -s
netstat -i

# 8. DNSé…ç½®æ£€æŸ¥
cat /etc/resolv.conf
cat /etc/hosts
</div>

<h4>ğŸš¨ å¯ç–‘ç½‘ç»œæ´»åŠ¨ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸ç›‘å¬ç«¯å£</strong> - éæ ‡å‡†ç«¯å£ä¸Šçš„ç›‘å¬æœåŠ¡</li>
<li><strong>å¤–è¿å¯ç–‘IP</strong> - è¿æ¥åˆ°æ¶æ„æˆ–æœªçŸ¥IPåœ°å€</li>
<li><strong>å¤§é‡å¹¶å‘è¿æ¥</strong> - å¼‚å¸¸é«˜çš„è¿æ¥æ•°é‡</li>
<li><strong>éæ ‡å‡†åè®®</strong> - ä½¿ç”¨ç½•è§ç«¯å£æˆ–åè®®</li>
<li><strong>åå‘è¿æ¥</strong> - ç³»ç»Ÿä¸»åŠ¨è¿æ¥å¤–éƒ¨åœ°å€</li>
</ul>

<h4>ğŸ”§ ç½‘ç»œåˆ†ææŠ€å·§</h4>
<ol>
<li><strong>ç«¯å£æ‰«ææ£€æµ‹</strong> - è¯†åˆ«ç«¯å£æ‰«æè¡Œä¸º</li>
<li><strong>æµé‡åŸºçº¿å»ºç«‹</strong> - å»ºç«‹æ­£å¸¸ç½‘ç»œæµé‡æ¨¡å¼</li>
<li><strong>åœ°ç†ä½ç½®åˆ†æ</strong> - åˆ†æè¿æ¥çš„åœ°ç†åˆ†å¸ƒ</li>
<li><strong>åè®®åˆ†æ</strong> - æ·±å…¥åˆ†æç½‘ç»œåè®®ä½¿ç”¨</li>
<li><strong>æ—¶é—´æ¨¡å¼åˆ†æ</strong> - åˆ†æç½‘ç»œæ´»åŠ¨çš„æ—¶é—´è§„å¾‹</li>
</ol>

<h4>ğŸ›¡ï¸ ç½‘ç»œå®‰å…¨é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>å…³é—­ä¸å¿…è¦çš„ç½‘ç»œæœåŠ¡å’Œç«¯å£</li>
<li>é…ç½®é˜²ç«å¢™è§„åˆ™é™åˆ¶ç½‘ç»œè®¿é—®</li>
<li>ä½¿ç”¨ç½‘ç»œç›‘æ§å·¥å…·å®æ—¶ç›‘æ§æµé‡</li>
<li>å®šæœŸæ£€æŸ¥å’Œæ›´æ–°ç½‘ç»œå®‰å…¨ç­–ç•¥</li>
<li>å®æ–½ç½‘ç»œåˆ†æ®µå’Œè®¿é—®æ§åˆ¶</li>
</ul>

<h4>âš ï¸ æ£€æŸ¥æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ³¨æ„åŒºåˆ†æ­£å¸¸ä¸šåŠ¡æµé‡å’Œå¼‚å¸¸æµé‡</li>
<li>å…³æ³¨åŠ å¯†æµé‡ä¸­çš„å¼‚å¸¸æ¨¡å¼</li>
<li>ç›‘æ§DNSæŸ¥è¯¢çš„å¼‚å¸¸æ¨¡å¼</li>
<li>å®šæœŸæ›´æ–°å¨èƒæƒ…æŠ¥å’Œæ¶æ„IPåˆ—è¡¨</li>
</ul>
</div>
    `,
    
    process: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>âš™ï¸ è¿›ç¨‹å®‰å…¨æ£€æŸ¥ä¸åˆ†ææŒ‡å—</h3>

<h4>ğŸ“– è¿›ç¨‹æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ¶æ„è¿›ç¨‹æ˜¯æ”»å‡»è€…åœ¨ç³»ç»Ÿä¸­æ‰§è¡Œæ¶æ„æ´»åŠ¨çš„è½½ä½“ã€‚é€šè¿‡è¿›ç¨‹åˆ†æå¯ä»¥å‘ç°åé—¨ç¨‹åºã€æŒ–çŸ¿æœ¨é©¬ã€æ•°æ®çªƒå–å·¥å…·ç­‰æ¶æ„è½¯ä»¶ã€‚</p>

<h4>ğŸ” è¿›ç¨‹æ£€æŸ¥çš„æ ¸å¿ƒæ–¹æ³•</h4>
<ol>
<li><strong>è¿›ç¨‹è¡Œä¸ºåˆ†æ</strong> - åˆ†æè¿›ç¨‹çš„è¿è¡Œè¡Œä¸ºå’Œèµ„æºä½¿ç”¨</li>
<li><strong>çˆ¶å­å…³ç³»æ£€æŸ¥</strong> - åˆ†æè¿›ç¨‹çš„å¯åŠ¨æ¥æº</li>
<li><strong>ç½‘ç»œè¿æ¥å…³è”</strong> - æ£€æŸ¥è¿›ç¨‹çš„ç½‘ç»œæ´»åŠ¨</li>
<li><strong>æ–‡ä»¶è®¿é—®ç›‘æ§</strong> - ç›‘æ§è¿›ç¨‹çš„æ–‡ä»¶æ“ä½œ</li>
<li><strong>æƒé™ç­‰çº§å®¡æŸ¥</strong> - æ£€æŸ¥è¿›ç¨‹çš„è¿è¡Œæƒé™</li>
</ol>

<h4>ğŸ’» è¿›ç¨‹æ£€æŸ¥å…³é”®å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
ps aux
ps -ef

# 2. æŒ‰CPUä½¿ç”¨ç‡æ’åº
ps aux --sort=-%cpu | head -20

# 3. æŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åº
ps aux --sort=-%mem | head -20

# 4. æŸ¥çœ‹è¿›ç¨‹æ ‘ç»“æ„
pstree -p
ps -ejH

# 5. æŸ¥çœ‹è¿›ç¨‹çš„ç½‘ç»œè¿æ¥
lsof -i
ss -tulnp

# 6. æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶
lsof -p PID
ls -la /proc/PID/fd/

# 7. æ£€æŸ¥å¯ç–‘è„šæœ¬è¿›ç¨‹
ps aux | grep -E 'bash|sh|python|perl|php|nc'

# 8. æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨çš„è¿›ç¨‹
systemctl list-units --type=service --state=running

# 9. æ£€æŸ¥è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´
ps -eo pid,lstart,cmd
</div>

<h4>ğŸš¨ å¯ç–‘è¿›ç¨‹ç‰¹å¾</h4>
<ul>
<li><strong>é«˜CPUä½¿ç”¨ç‡</strong> - å¼‚å¸¸é«˜çš„CPUå ç”¨ï¼ˆå¯èƒ½æ˜¯æŒ–çŸ¿ç¨‹åºï¼‰</li>
<li><strong>å¼‚å¸¸ç½‘ç»œè¿æ¥</strong> - è¿æ¥åˆ°å¯ç–‘IPæˆ–ç«¯å£</li>
<li><strong>éšè—è¿›ç¨‹å</strong> - ä½¿ç”¨ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦éšè—</li>
<li><strong>ä¸´æ—¶ç›®å½•æ‰§è¡Œ</strong> - ä»/tmpã€/var/tmpç­‰ç›®å½•è¿è¡Œ</li>
<li><strong>æ— çˆ¶è¿›ç¨‹</strong> - å­¤å„¿è¿›ç¨‹æˆ–å¼‚å¸¸çš„çˆ¶å­å…³ç³»</li>
</ul>

<h4>ğŸ”§ è¿›ç¨‹åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>èµ„æºä½¿ç”¨åˆ†æ</strong> - ç›‘æ§CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨æƒ…å†µ</li>
<li><strong>å¯åŠ¨æ—¶é—´å…³è”</strong> - ä¸å…¥ä¾µæ—¶é—´è¿›è¡Œå…³è”åˆ†æ</li>
<li><strong>å‘½ä»¤è¡Œå‚æ•°æ£€æŸ¥</strong> - åˆ†æè¿›ç¨‹çš„å¯åŠ¨å‚æ•°</li>
<li><strong>æ–‡ä»¶å“ˆå¸Œæ ¡éªŒ</strong> - å¯¹å¯ç–‘ç¨‹åºè¿›è¡Œå“ˆå¸Œæ ¡éªŒ</li>
<li><strong>è¡Œä¸ºç›‘æ§</strong> - ä½¿ç”¨straceç­‰å·¥å…·ç›‘æ§ç³»ç»Ÿè°ƒç”¨</li>
</ol>

<h4>ğŸ›¡ï¸ è¿›ç¨‹å®‰å…¨é˜²æŠ¤</h4>
<ul>
<li>å®šæœŸæ£€æŸ¥è¿è¡Œè¿›ç¨‹çš„åˆæ³•æ€§</li>
<li>ç›‘æ§å¼‚å¸¸çš„èµ„æºä½¿ç”¨æƒ…å†µ</li>
<li>é™åˆ¶è¿›ç¨‹çš„æ‰§è¡Œæƒé™</li>
<li>ä½¿ç”¨è¿›ç¨‹ç›‘æ§å·¥å…·å®æ—¶å‘Šè­¦</li>
<li>å®šæœŸæ›´æ–°å’Œæ‰«ææ¶æ„è½¯ä»¶ç‰¹å¾</li>
</ul>

<h4>âš ï¸ åˆ†ææ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æŸäº›ç³»ç»Ÿè¿›ç¨‹å¯èƒ½è¢«æ¶æ„ç¨‹åºä¼ªè£…</li>
<li>æ³¨æ„è¿›ç¨‹çš„æ•°å­—ç­¾åå’Œæ¥æºéªŒè¯</li>
<li>å…³æ³¨è¿›ç¨‹çš„ç½‘ç»œé€šä¿¡æ¨¡å¼</li>
<li>é¿å…ç›´æ¥ç»ˆæ­¢å¯ç–‘è¿›ç¨‹ï¼Œå…ˆæ”¶é›†è¯æ®</li>
</ul>
</div>
    `,
    
    filesystem: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ“ æ–‡ä»¶ç³»ç»Ÿå®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ”»å‡»è€…æ¤å…¥åé—¨ã€å­˜å‚¨æ¶æ„æ–‡ä»¶å’Œç¯¡æ”¹ç³»ç»Ÿé…ç½®çš„ä¸»è¦ç›®æ ‡ã€‚é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å¯ä»¥å‘ç°æ¶æ„æ–‡ä»¶ã€æƒé™å¼‚å¸¸å’Œç³»ç»Ÿå®Œæ•´æ€§é—®é¢˜ã€‚</p>

<h4>ğŸ” æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æƒé™å¼‚å¸¸æ£€æŸ¥</strong> - å‘ç°SUID/SGIDç­‰ç‰¹æ®Šæƒé™æ–‡ä»¶</li>
<li><strong>æ–‡ä»¶å®Œæ•´æ€§éªŒè¯</strong> - æ£€æŸ¥å…³é”®æ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹</li>
<li><strong>éšè—æ–‡ä»¶å‘ç°</strong> - æŸ¥æ‰¾éšè—çš„æ¶æ„æ–‡ä»¶</li>
<li><strong>æ—¶é—´æˆ³åˆ†æ</strong> - åˆ†ææ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´</li>
<li><strong>æ–‡ä»¶ç±»å‹è¯†åˆ«</strong> - è¯†åˆ«ä¼ªè£…çš„æ¶æ„æ–‡ä»¶</li>
</ol>

<h4>ğŸ’» æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æŸ¥æ‰¾SUIDæ–‡ä»¶
find / -perm -4000 -type f 2>/dev/null

# 2. æŸ¥æ‰¾SGIDæ–‡ä»¶
find / -perm -2000 -type f 2>/dev/null

# 3. æŸ¥æ‰¾æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶
find / -mtime -7 -type f 2>/dev/null | grep -v proc

# 4. æŸ¥æ‰¾éšè—æ–‡ä»¶
find / -name ".*" -type f 2>/dev/null | head -50

# 5. æŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆå¯èƒ½çš„æ•°æ®æ”¶é›†ï¼‰
find / -size +100M -type f 2>/dev/null

# 6. æ£€æŸ¥ä¸´æ—¶ç›®å½•
ls -la /tmp /var/tmp /dev/shm

# 7. æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶
find /tmp /var/tmp -type f -executable 2>/dev/null

# 8. æ£€æŸ¥ç³»ç»Ÿå…³é”®ç›®å½•
ls -la /bin /sbin /usr/bin /usr/sbin

# 9. æŸ¥æ‰¾æœ€è¿‘è®¿é—®çš„æ–‡ä»¶
find / -atime -1 -type f 2>/dev/null | head -20

# 10. æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
md5sum /bin/ls /bin/ps /bin/netstat
</div>

<h4>ğŸš¨ å¯ç–‘æ–‡ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸SUIDæ–‡ä»¶</strong> - åœ¨ä¸´æ—¶ç›®å½•æˆ–å¼‚å¸¸ä½ç½®çš„SUIDæ–‡ä»¶</li>
<li><strong>éšè—å¯æ‰§è¡Œæ–‡ä»¶</strong> - ä»¥ç‚¹å¼€å¤´çš„å¯æ‰§è¡Œæ–‡ä»¶</li>
<li><strong>ç³»ç»Ÿæ–‡ä»¶ç¯¡æ”¹</strong> - å…³é”®ç³»ç»Ÿå‘½ä»¤è¢«æ›¿æ¢</li>
<li><strong>å¼‚å¸¸å¤§æ–‡ä»¶</strong> - å¯èƒ½åŒ…å«çªƒå–çš„æ•°æ®</li>
<li><strong>æ—¶é—´æˆ³å¼‚å¸¸</strong> - ä¿®æ”¹æ—¶é—´ä¸å…¥ä¾µæ—¶é—´ç›¸å…³</li>
</ul>

<h4>ğŸ”§ æ–‡ä»¶åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ–‡ä»¶æŒ‡çº¹å¯¹æ¯”</strong> - ä¸å·²çŸ¥æ¶æ„æ–‡ä»¶å“ˆå¸Œå¯¹æ¯”</li>
<li><strong>æ–‡ä»¶ç±»å‹æ£€æµ‹</strong> - ä½¿ç”¨fileå‘½ä»¤æ£€æŸ¥çœŸå®ç±»å‹</li>
<li><strong>å­—ç¬¦ä¸²åˆ†æ</strong> - ä½¿ç”¨stringså‘½ä»¤åˆ†ææ–‡ä»¶å†…å®¹</li>
<li><strong>æƒé™å®¡è®¡</strong> - æ£€æŸ¥æ–‡ä»¶æƒé™çš„åˆç†æ€§</li>
<li><strong>ä¾èµ–å…³ç³»åˆ†æ</strong> - åˆ†ææ–‡ä»¶çš„ä¾èµ–å’Œè°ƒç”¨å…³ç³»</li>
</ol>

<h4>ğŸ›¡ï¸ æ–‡ä»¶ç³»ç»Ÿå®‰å…¨å»ºè®®</h4>
<ul>
<li>å®šæœŸè¿›è¡Œæ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥</li>
<li>é™åˆ¶ä¸´æ—¶ç›®å½•çš„æ‰§è¡Œæƒé™</li>
<li>ç›‘æ§å…³é”®ç›®å½•çš„æ–‡ä»¶å˜åŒ–</li>
<li>ä½¿ç”¨æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§å·¥å…·</li>
<li>å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œæ—¥å¿—</li>
</ul>

<h4>âš ï¸ æ£€æŸ¥æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>é¿å…åœ¨æ£€æŸ¥è¿‡ç¨‹ä¸­æ‰§è¡Œå¯ç–‘æ–‡ä»¶</li>
<li>å¯¹é‡è¦å‘ç°è¿›è¡Œå¤‡ä»½å’Œå–è¯</li>
<li>æ³¨æ„æ–‡ä»¶çš„è½¯é“¾æ¥å’Œç¡¬é“¾æ¥å…³ç³»</li>
<li>å…³æ³¨æ–‡ä»¶çš„æ•°å­—ç­¾åå’Œæ¥æº</li>
</ul>
</div>
    `,
    
    package: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ“¦ è½¯ä»¶åŒ…å®‰å…¨æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– è½¯ä»¶åŒ…æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ¶æ„è½¯ä»¶åŒ…å¯èƒ½åŒ…å«åé—¨ã€æœ¨é©¬æˆ–å…¶ä»–æ¶æ„ä»£ç ã€‚é€šè¿‡è½¯ä»¶åŒ…æ£€æŸ¥å¯ä»¥å‘ç°æœªæˆæƒå®‰è£…çš„è½¯ä»¶ã€å¯ç–‘çš„åŒ…ç®¡ç†å™¨æ´»åŠ¨å’Œæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ã€‚</p>

<h4>ğŸ” è½¯ä»¶åŒ…æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>åŒ…å®Œæ•´æ€§éªŒè¯</strong> - æ£€æŸ¥è½¯ä»¶åŒ…çš„æ•°å­—ç­¾åå’Œæ ¡éªŒå’Œ</li>
<li><strong>å®‰è£…å†å²å®¡è®¡</strong> - åˆ†æè½¯ä»¶åŒ…çš„å®‰è£…æ—¶é—´å’Œæ¥æº</li>
<li><strong>ä¾èµ–å…³ç³»æ£€æŸ¥</strong> - è¯†åˆ«å¼‚å¸¸çš„ä¾èµ–å…³ç³»</li>
<li><strong>ç‰ˆæœ¬ä¸€è‡´æ€§</strong> - æ£€æŸ¥è½¯ä»¶åŒ…ç‰ˆæœ¬çš„åˆç†æ€§</li>
<li><strong>æ¥æºå¯ä¿¡åº¦</strong> - éªŒè¯è½¯ä»¶åŒ…çš„æ¥æºä»“åº“</li>
</ol>

<h4>ğŸ’» è½¯ä»¶åŒ…æ£€æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# Debian/Ubuntuç³»ç»Ÿ
# 1. æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ…
dpkg -l
apt list --installed

# 2. æŸ¥çœ‹è½¯ä»¶åŒ…å®‰è£…å†å²
grep " install " /var/log/dpkg.log
grep " install " /var/log/apt/history.log

# 3. æ£€æŸ¥è½¯ä»¶åŒ…å®Œæ•´æ€§
debsums -c
dpkg --verify

# 4. æŸ¥çœ‹è½¯ä»¶åŒ…ä¿¡æ¯
dpkg -s package_name
apt show package_name

# RedHat/CentOSç³»ç»Ÿ
# 1. æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ…
rpm -qa
yum list installed

# 2. æŸ¥çœ‹è½¯ä»¶åŒ…å®‰è£…å†å²
grep "Installed:" /var/log/yum.log
rpm -qa --last

# 3. æ£€æŸ¥è½¯ä»¶åŒ…å®Œæ•´æ€§
rpm -Va
rpm --verify package_name

# 4. æŸ¥çœ‹è½¯ä»¶åŒ…ä¿¡æ¯
rpm -qi package_name
yum info package_name

# é€šç”¨å‘½ä»¤
# æŸ¥æ‰¾æœ€è¿‘å®‰è£…çš„è½¯ä»¶åŒ…
find /var/cache/apt/archives -name "*.deb" -mtime -7
find /var/cache/yum -name "*.rpm" -mtime -7
</div>

<h4>ğŸš¨ å¯ç–‘è½¯ä»¶åŒ…ç‰¹å¾</h4>
<ul>
<li><strong>æœªçŸ¥æ¥æºåŒ…</strong> - æ¥è‡ªéå®˜æ–¹ä»“åº“çš„è½¯ä»¶åŒ…</li>
<li><strong>ç­¾åå¼‚å¸¸</strong> - ç¼ºå°‘æ•°å­—ç­¾åæˆ–ç­¾åéªŒè¯å¤±è´¥</li>
<li><strong>ç‰ˆæœ¬å¼‚å¸¸</strong> - ç‰ˆæœ¬å·ä¸ç¬¦åˆæ­£å¸¸è§„å¾‹</li>
<li><strong>å®‰è£…æ—¶é—´å¯ç–‘</strong> - åœ¨å…¥ä¾µæ—¶é—´é™„è¿‘å®‰è£…çš„è½¯ä»¶åŒ…</li>
<li><strong>ä¾èµ–å¼‚å¸¸</strong> - åŒ…å«å¼‚å¸¸ä¾èµ–å…³ç³»çš„è½¯ä»¶åŒ…</li>
</ul>

<h4>ğŸ”§ è½¯ä»¶åŒ…åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´çº¿åˆ†æ</strong> - å°†å®‰è£…æ—¶é—´ä¸å®‰å…¨äº‹ä»¶å…³è”</li>
<li><strong>ä¾èµ–æ ‘åˆ†æ</strong> - åˆ†æè½¯ä»¶åŒ…çš„å®Œæ•´ä¾èµ–å…³ç³»</li>
<li><strong>æ–‡ä»¶æ¸…å•æ£€æŸ¥</strong> - æ£€æŸ¥è½¯ä»¶åŒ…å®‰è£…çš„æ–‡ä»¶åˆ—è¡¨</li>
<li><strong>ä»“åº“æºéªŒè¯</strong> - éªŒè¯è½¯ä»¶åŒ…æ¥æºçš„å¯ä¿¡åº¦</li>
<li><strong>ç‰ˆæœ¬å¯¹æ¯”</strong> - ä¸å®˜æ–¹ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”</li>
</ol>

<h4>ğŸ›¡ï¸ è½¯ä»¶åŒ…å®‰å…¨å»ºè®®</h4>
<ul>
<li>åªä»å¯ä¿¡çš„å®˜æ–¹ä»“åº“å®‰è£…è½¯ä»¶åŒ…</li>
<li>å®šæœŸæ›´æ–°è½¯ä»¶åŒ…åˆ°æœ€æ–°ç‰ˆæœ¬</li>
<li>å¯ç”¨è½¯ä»¶åŒ…ç­¾åéªŒè¯</li>
<li>ç›‘æ§è½¯ä»¶åŒ…çš„å®‰è£…å’Œæ›´æ–°æ´»åŠ¨</li>
<li>å®šæœŸè¿›è¡Œè½¯ä»¶åŒ…å®Œæ•´æ€§æ£€æŸ¥</li>
</ul>

<h4>âš ï¸ æ£€æŸ¥æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ³¨æ„åŒºåˆ†æ­£å¸¸çš„ç³»ç»Ÿæ›´æ–°å’Œæ¶æ„å®‰è£…</li>
<li>å…³æ³¨ç¬¬ä¸‰æ–¹ä»“åº“çš„å®‰å…¨æ€§</li>
<li>æ£€æŸ¥è½¯ä»¶åŒ…çš„æ•°å­—ç­¾åæœ‰æ•ˆæ€§</li>
<li>ç›‘æ§åŒ…ç®¡ç†å™¨çš„é…ç½®æ–‡ä»¶å˜åŒ–</li>
</ul>
</div>
    `,
    
    persistence: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ”„ æŒä¹…åŒ–æœºåˆ¶æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– æŒä¹…åŒ–æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>æ”»å‡»è€…ä¸ºäº†ç»´æŒå¯¹ç³»ç»Ÿçš„é•¿æœŸè®¿é—®ï¼Œä¼šå»ºç«‹å„ç§æŒä¹…åŒ–æœºåˆ¶ã€‚è¿™äº›æœºåˆ¶ç¡®ä¿å³ä½¿ç³»ç»Ÿé‡å¯æˆ–æ£€æµ‹åˆ°å…¥ä¾µï¼Œæ”»å‡»è€…ä»èƒ½é‡æ–°è·å¾—è®¿é—®æƒé™ã€‚</p>

<h4>ğŸ” æŒä¹…åŒ–æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>å¯åŠ¨é¡¹æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»Ÿå’Œç”¨æˆ·çº§åˆ«çš„å¯åŠ¨é¡¹</li>
<li><strong>è®¡åˆ’ä»»åŠ¡å®¡è®¡</strong> - åˆ†æcronå’Œsystemdå®šæ—¶ä»»åŠ¡</li>
<li><strong>æœåŠ¡é…ç½®æ£€æŸ¥</strong> - æ£€æŸ¥ç³»ç»ŸæœåŠ¡çš„é…ç½®</li>
<li><strong>SSHå¯†é’¥å®¡è®¡</strong> - æ£€æŸ¥SSHå…¬é’¥è®¤è¯é…ç½®</li>
<li><strong>ç¯å¢ƒå˜é‡æ£€æŸ¥</strong> - æ£€æŸ¥å¯èƒ½è¢«åŠ«æŒçš„ç¯å¢ƒå˜é‡</li>
</ol>

<h4>ğŸ’» æŒä¹…åŒ–æ£€æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æ£€æŸ¥ç³»ç»ŸæœåŠ¡
systemctl list-units --type=service
systemctl list-unit-files --type=service --state=enabled

# 2. æ£€æŸ¥cronè®¡åˆ’ä»»åŠ¡
crontab -l
ls -la /etc/cron*
cat /etc/crontab
ls -la /var/spool/cron/

# 3. æ£€æŸ¥atè®¡åˆ’ä»»åŠ¡
atq
ls -la /var/spool/at/

# 4. æ£€æŸ¥SSHå…¬é’¥
cat ~/.ssh/authorized_keys
find /home -name "authorized_keys" -exec ls -la {} \\;

# 5. æ£€æŸ¥å¯åŠ¨è„šæœ¬
ls -la /etc/init.d/
ls -la /etc/rc*.d/
cat /etc/rc.local

# 6. æ£€æŸ¥systemdç”¨æˆ·æœåŠ¡
systemctl --user list-units --type=service
ls -la ~/.config/systemd/user/

# 7. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
cat /etc/environment
cat /etc/profile
cat ~/.bashrc ~/.profile

# 8. æ£€æŸ¥å†…æ ¸æ¨¡å—
lsmod
ls -la /etc/modules-load.d/

# 9. æ£€æŸ¥å®šæ—¶å™¨
systemctl list-timers
</div>

<h4>ğŸš¨ å¯ç–‘æŒä¹…åŒ–ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸å¯åŠ¨æœåŠ¡</strong> - æœªçŸ¥æˆ–å¯ç–‘çš„ç³»ç»ŸæœåŠ¡</li>
<li><strong>éšè—è®¡åˆ’ä»»åŠ¡</strong> - åœ¨éæ ‡å‡†ä½ç½®çš„cronä»»åŠ¡</li>
<li><strong>æœªæˆæƒSSHå¯†é’¥</strong> - ä¸æ˜æ¥æºçš„å…¬é’¥æ–‡ä»¶</li>
<li><strong>ä¿®æ”¹çš„å¯åŠ¨è„šæœ¬</strong> - è¢«ç¯¡æ”¹çš„ç³»ç»Ÿå¯åŠ¨è„šæœ¬</li>
<li><strong>å¼‚å¸¸ç¯å¢ƒå˜é‡</strong> - å¯ç–‘çš„PATHæˆ–LD_PRELOADè®¾ç½®</li>
</ul>

<h4>ğŸ”§ æŒä¹…åŒ–åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>æ—¶é—´å…³è”åˆ†æ</strong> - å°†é…ç½®ä¿®æ”¹æ—¶é—´ä¸å…¥ä¾µæ—¶é—´å…³è”</li>
<li><strong>æƒé™æ£€æŸ¥</strong> - æ£€æŸ¥é…ç½®æ–‡ä»¶çš„æƒé™å’Œæ‰€æœ‰è€…</li>
<li><strong>å†…å®¹åˆ†æ</strong> - åˆ†æè„šæœ¬å’Œé…ç½®æ–‡ä»¶çš„å†…å®¹</li>
<li><strong>ä¾èµ–å…³ç³»</strong> - åˆ†ææœåŠ¡å’Œä»»åŠ¡çš„ä¾èµ–å…³ç³»</li>
<li><strong>ç½‘ç»œè¿æ¥</strong> - æ£€æŸ¥æŒä¹…åŒ–æœºåˆ¶çš„ç½‘ç»œæ´»åŠ¨</li>
</ol>

<h4>ğŸ›¡ï¸ æŒä¹…åŒ–é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>å®šæœŸå®¡è®¡ç³»ç»Ÿå¯åŠ¨é¡¹å’ŒæœåŠ¡é…ç½®</li>
<li>ç›‘æ§è®¡åˆ’ä»»åŠ¡çš„åˆ›å»ºå’Œä¿®æ”¹</li>
<li>ä¸¥æ ¼æ§åˆ¶SSHå¯†é’¥çš„ç®¡ç†</li>
<li>ä½¿ç”¨é…ç½®ç®¡ç†å·¥å…·ç›‘æ§ç³»ç»Ÿé…ç½®å˜åŒ–</li>
<li>å®æ–½æœ€å°æƒé™åŸåˆ™</li>
</ul>

<h4>âš ï¸ æ£€æŸ¥æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æŸäº›æŒä¹…åŒ–æœºåˆ¶å¯èƒ½ä¼ªè£…æˆæ­£å¸¸æœåŠ¡</li>
<li>æ³¨æ„æ£€æŸ¥ç”¨æˆ·çº§åˆ«çš„æŒä¹…åŒ–é…ç½®</li>
<li>å…³æ³¨éšè—åœ¨æ­£å¸¸é…ç½®ä¸­çš„æ¶æ„ä»£ç </li>
<li>æ£€æŸ¥é…ç½®æ–‡ä»¶çš„å®Œæ•´æ€§å’Œæ•°å­—ç­¾å</li>
</ul>
</div>
    `,
    
    integrity: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ›¡ï¸ ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥æŒ‡å—</h3>

<h4>ğŸ“– ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥çš„é‡è¦æ€§</h4>
<p>ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥æ˜¯å‘ç°ç³»ç»Ÿæ–‡ä»¶ç¯¡æ”¹ã€rootkitæ„ŸæŸ“å’Œé«˜çº§æŒç»­å¨èƒ(APT)çš„å…³é”®æ‰‹æ®µã€‚é€šè¿‡å¯¹æ¯”æ–‡ä»¶å“ˆå¸Œå€¼å’Œç³»ç»ŸåŸºçº¿ï¼Œå¯ä»¥å‘ç°éšè”½çš„ç³»ç»Ÿä¿®æ”¹ã€‚</p>

<h4>ğŸ” å®Œæ•´æ€§æ£€æŸ¥è¦ç‚¹</h4>
<ol>
<li><strong>æ–‡ä»¶å“ˆå¸ŒéªŒè¯</strong> - å¯¹æ¯”å…³é”®æ–‡ä»¶çš„å“ˆå¸Œå€¼</li>
<li><strong>ç³»ç»ŸåŸºçº¿å¯¹æ¯”</strong> - ä¸å·²çŸ¥è‰¯å¥½çŠ¶æ€è¿›è¡Œå¯¹æ¯”</li>
<li><strong>æ•°å­—ç­¾åéªŒè¯</strong> - æ£€æŸ¥æ–‡ä»¶çš„æ•°å­—ç­¾å</li>
<li><strong>Rootkitæ£€æµ‹</strong> - ä½¿ç”¨ä¸“ä¸šå·¥å…·æ£€æµ‹rootkit</li>
<li><strong>å†…æ ¸å®Œæ•´æ€§</strong> - æ£€æŸ¥å†…æ ¸æ¨¡å—å’Œç³»ç»Ÿè°ƒç”¨</li>
</ol>

<h4>ğŸ’» å®Œæ•´æ€§æ£€æŸ¥å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. å…³é”®ç³»ç»Ÿæ–‡ä»¶å“ˆå¸Œæ£€æŸ¥
md5sum /bin/ls /bin/ps /bin/netstat /usr/bin/top
sha256sum /bin/bash /bin/sh /usr/bin/ssh

# 2. ä½¿ç”¨AIDEè¿›è¡Œå®Œæ•´æ€§æ£€æŸ¥
aide --init
aide --check

# 3. ä½¿ç”¨Tripwireè¿›è¡Œæ£€æŸ¥
tripwire --check

# 4. æ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶æƒé™
find /bin /sbin /usr/bin /usr/sbin -type f -exec ls -l {} \\;

# 5. ä½¿ç”¨chkrootkitæ£€æµ‹rootkit
chkrootkit

# 6. ä½¿ç”¨rkhunteræ£€æµ‹rootkit
rkhunter --check

# 7. æ£€æŸ¥å†…æ ¸æ¨¡å—
lsmod
cat /proc/modules

# 8. æ£€æŸ¥ç³»ç»Ÿè°ƒç”¨è¡¨
cat /proc/kallsyms | grep sys_call_table

# 9. ä½¿ç”¨debsumsæ£€æŸ¥DebianåŒ…å®Œæ•´æ€§
debsums -c

# 10. ä½¿ç”¨rpméªŒè¯RedHatåŒ…å®Œæ•´æ€§
rpm -Va
</div>

<h4>ğŸš¨ å®Œæ•´æ€§å¼‚å¸¸ç‰¹å¾</h4>
<ul>
<li><strong>å“ˆå¸Œå€¼ä¸åŒ¹é…</strong> - å…³é”®æ–‡ä»¶çš„å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–</li>
<li><strong>æ–‡ä»¶å¤§å°å¼‚å¸¸</strong> - ç³»ç»Ÿæ–‡ä»¶å¤§å°ä¸é¢„æœŸä¸ç¬¦</li>
<li><strong>ä¿®æ”¹æ—¶é—´å¼‚å¸¸</strong> - ç³»ç»Ÿæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å¯ç–‘</li>
<li><strong>æƒé™å˜åŒ–</strong> - å…³é”®æ–‡ä»¶æƒé™è¢«å¼‚å¸¸ä¿®æ”¹</li>
<li><strong>æ•°å­—ç­¾åå¤±æ•ˆ</strong> - æ–‡ä»¶çš„æ•°å­—ç­¾åéªŒè¯å¤±è´¥</li>
</ul>

<h4>ğŸ”§ å®Œæ•´æ€§åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>åŸºçº¿å»ºç«‹</strong> - åœ¨ç³»ç»Ÿå®‰è£…åç«‹å³å»ºç«‹å®Œæ•´æ€§åŸºçº¿</li>
<li><strong>å®šæœŸæ£€æŸ¥</strong> - å»ºç«‹å®šæœŸçš„å®Œæ•´æ€§æ£€æŸ¥æœºåˆ¶</li>
<li><strong>å¢é‡åˆ†æ</strong> - åˆ†æä¸¤æ¬¡æ£€æŸ¥ä¹‹é—´çš„å˜åŒ–</li>
<li><strong>ç™½åå•ç®¡ç†</strong> - ç»´æŠ¤å·²çŸ¥è‰¯å¥½å˜åŒ–çš„ç™½åå•</li>
<li><strong>å‘Šè­¦å…³è”</strong> - å°†å®Œæ•´æ€§å‘Šè­¦ä¸å…¶ä»–å®‰å…¨äº‹ä»¶å…³è”</li>
</ol>

<h4>ğŸ›¡ï¸ å®Œæ•´æ€§ä¿æŠ¤å»ºè®®</h4>
<ul>
<li>éƒ¨ç½²æ–‡ä»¶å®Œæ•´æ€§ç›‘æ§ç³»ç»Ÿ(FIM)</li>
<li>å®šæœŸæ›´æ–°å®Œæ•´æ€§æ£€æŸ¥çš„åŸºçº¿</li>
<li>ä½¿ç”¨åªè¯»å­˜å‚¨ä¿æŠ¤å…³é”®é…ç½®</li>
<li>å®æ–½ä»£ç ç­¾åå’ŒéªŒè¯æœºåˆ¶</li>
<li>å»ºç«‹å®Œæ•´æ€§æ£€æŸ¥çš„è‡ªåŠ¨åŒ–æµç¨‹</li>
</ul>

<h4>âš ï¸ æ£€æŸ¥æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ­£å¸¸çš„ç³»ç»Ÿæ›´æ–°ä¹Ÿä¼šæ”¹å˜æ–‡ä»¶å“ˆå¸Œå€¼</li>
<li>æŸäº›rootkitå¯èƒ½ç»•è¿‡å¸¸è§„æ£€æµ‹å·¥å…·</li>
<li>éœ€è¦ä½¿ç”¨å¯ä¿¡çš„å¤–éƒ¨å·¥å…·è¿›è¡Œæ£€æŸ¥</li>
<li>å…³æ³¨å†…æ ¸çº§åˆ«çš„å®Œæ•´æ€§æ£€æŸ¥</li>
</ul>
</div>
    `,
    
    malware: `
<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 10px 0;">
<h3>ğŸ¦  æ¶æ„è½¯ä»¶æ£€æµ‹ä¸åˆ†ææŒ‡å—</h3>

<h4>ğŸ“– æ¶æ„è½¯ä»¶æ£€æµ‹çš„é‡è¦æ€§</h4>
<p>æ¶æ„è½¯ä»¶æ˜¯ç½‘ç»œæ”»å‡»çš„ä¸»è¦è½½ä½“ï¼ŒåŒ…æ‹¬ç—…æ¯’ã€æœ¨é©¬ã€è •è™«ã€å‹’ç´¢è½¯ä»¶ã€æŒ–çŸ¿ç¨‹åºç­‰ã€‚åŠæ—¶å‘ç°å’Œåˆ†ææ¶æ„è½¯ä»¶å¯¹äºéåˆ¶æ”»å‡»æ‰©æ•£å’Œè¯„ä¼°æŸå¤±è‡³å…³é‡è¦ã€‚</p>

<h4>ğŸ” æ¶æ„è½¯ä»¶æ£€æµ‹è¦ç‚¹</h4>
<ol>
<li><strong>è¡Œä¸ºç‰¹å¾è¯†åˆ«</strong> - è¯†åˆ«æ¶æ„è½¯ä»¶çš„è¡Œä¸ºæ¨¡å¼</li>
<li><strong>æ–‡ä»¶ç‰¹å¾åˆ†æ</strong> - åˆ†æå¯ç–‘æ–‡ä»¶çš„ç‰¹å¾</li>
<li><strong>ç½‘ç»œé€šä¿¡æ£€æµ‹</strong> - å‘ç°æ¶æ„çš„ç½‘ç»œé€šä¿¡</li>
<li><strong>ç³»ç»Ÿèµ„æºç›‘æ§</strong> - ç›‘æ§å¼‚å¸¸çš„èµ„æºä½¿ç”¨</li>
<li><strong>æŒä¹…åŒ–æœºåˆ¶</strong> - å‘ç°æ¶æ„è½¯ä»¶çš„æŒä¹…åŒ–æ‰‹æ®µ</li>
</ol>

<h4>ğŸ’» æ¶æ„è½¯ä»¶æ£€æµ‹å‘½ä»¤</h4>
<div style="background: #2d3748; color: #e2e8f0; padding: 15px; border-radius: 5px; font-family: monospace;">
# 1. æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹
ps aux | grep -E 'bash|sh|python|perl|php' | grep -v grep
ps aux --sort=-%cpu | head -20

# 2. æ£€æŸ¥ç½‘ç»œè¿æ¥
netstat -antp | grep ESTABLISHED
ss -antp | grep -v '127.0.0.1'

# 3. æŸ¥æ‰¾éšè—æ–‡ä»¶
find / -name ".*" -type f 2>/dev/null | head -50
find /tmp /var/tmp -type f -executable 2>/dev/null

# 4. æ£€æŸ¥å¼‚å¸¸å¤§æ–‡ä»¶
find / -size +100M -type f 2>/dev/null

# 5. æŸ¥æ‰¾æœ€è¿‘ä¿®æ”¹çš„å¯æ‰§è¡Œæ–‡ä»¶
find / -type f -executable -mtime -7 2>/dev/null

# 6. ä½¿ç”¨ClamAVæ‰«æ
clamscan -r /home /tmp /var/tmp

# 7. æ£€æŸ¥è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦
lsof -p PID

# 8. æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨
strace -p PID

# 9. æ£€æŸ¥å†…å­˜æ˜ å°„
cat /proc/PID/maps

# 10. æŸ¥æ‰¾å­—ç¬¦ä¸²ç‰¹å¾
strings suspicious_file | grep -E 'http|ftp|password|key'
</div>

<h4>ğŸš¨ æ¶æ„è½¯ä»¶ç‰¹å¾</h4>
<ul>
<li><strong>å¼‚å¸¸CPUä½¿ç”¨</strong> - æŒ–çŸ¿ç¨‹åºå¸¸è¡¨ç°ä¸ºé«˜CPUå ç”¨</li>
<li><strong>å¯ç–‘ç½‘ç»œè¿æ¥</strong> - è¿æ¥åˆ°C&CæœåŠ¡å™¨æˆ–æ¶æ„åŸŸå</li>
<li><strong>æ–‡ä»¶åŠ å¯†è¡Œä¸º</strong> - å‹’ç´¢è½¯ä»¶çš„æ–‡ä»¶åŠ å¯†æ´»åŠ¨</li>
<li><strong>æƒé™æå‡å°è¯•</strong> - å°è¯•è·å–æ›´é«˜æƒé™</li>
<li><strong>æ•°æ®æ”¶é›†è¡Œä¸º</strong> - æ”¶é›†æ•æ„Ÿä¿¡æ¯å’Œå‡­æ®</li>
</ul>

<h4>ğŸ”§ æ¶æ„è½¯ä»¶åˆ†ææŠ€å·§</h4>
<ol>
<li><strong>é™æ€åˆ†æ</strong> - ä¸æ‰§è¡Œæ–‡ä»¶çš„æƒ…å†µä¸‹åˆ†æå…¶ç‰¹å¾</li>
<li><strong>åŠ¨æ€åˆ†æ</strong> - åœ¨éš”ç¦»ç¯å¢ƒä¸­è§‚å¯Ÿè¿è¡Œè¡Œä¸º</li>
<li><strong>ç½‘ç»œæµé‡åˆ†æ</strong> - åˆ†ææ¶æ„è½¯ä»¶çš„ç½‘ç»œé€šä¿¡</li>
<li><strong>å†…å­˜åˆ†æ</strong> - åˆ†æå†…å­˜ä¸­çš„æ¶æ„ä»£ç </li>
<li><strong>å¨èƒæƒ…æŠ¥å…³è”</strong> - ä¸å·²çŸ¥å¨èƒæƒ…æŠ¥è¿›è¡Œå…³è”</li>
</ol>

<h4>ğŸ›¡ï¸ æ¶æ„è½¯ä»¶é˜²æŠ¤å»ºè®®</h4>
<ul>
<li>éƒ¨ç½²å¤šå±‚æ¬¡çš„åæ¶æ„è½¯ä»¶è§£å†³æ–¹æ¡ˆ</li>
<li>å®šæœŸæ›´æ–°æ¶æ„è½¯ä»¶ç‰¹å¾åº“</li>
<li>å®æ–½åº”ç”¨ç¨‹åºç™½åå•æœºåˆ¶</li>
<li>åŠ å¼ºé‚®ä»¶å’Œç½‘ç»œå®‰å…¨é˜²æŠ¤</li>
<li>å»ºç«‹æ¶æ„è½¯ä»¶åº”æ€¥å“åº”æµç¨‹</li>
</ul>

<h4>âš ï¸ åˆ†ææ³¨æ„äº‹é¡¹</h4>
<ul>
<li>åœ¨éš”ç¦»ç¯å¢ƒä¸­è¿›è¡Œæ¶æ„è½¯ä»¶åˆ†æ</li>
<li>é¿å…ç›´æ¥æ‰§è¡Œå¯ç–‘æ–‡ä»¶</li>
<li>æ³¨æ„æ¶æ„è½¯ä»¶çš„ååˆ†ææŠ€æœ¯</li>
<li>åŠæ—¶æ›´æ–°æ£€æµ‹å·¥å…·å’Œç‰¹å¾åº“</li>
</ul>
</div>
    `
  };
  
  return tutorials[category] || '<p>æš‚æ— æ•™ç¨‹å†…å®¹</p>';
}

function openTab(evt, tabName) {
  const tabcontent = document.getElementsByClassName("tabcontent");
  for (let i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  const tablinks = document.getElementsByClassName("tablinks");
  for (let i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}

function findAllMatches(text, searchTerm) {
  if (!searchTerm) return [];
  const regex = new RegExp(searchTerm, 'gi');
  const matches = [];
  let match;
  while ((match = regex.exec(text)) !== null) {
    matches.push({
      index: match.index,
      text: match[0],
      position: matches.length,
      end: match.index + match[0].length
    });
  }
  return matches;
}

function searchTabs() {
  const input = document.getElementById("searchInput").value.toLowerCase();
  if (!input) {
    updateSearchCount(0, -1);
    return;
  }

  searchResults = [];
  currentSearchIndex = -1;
  
  const tabs = document.getElementsByClassName("tabcontent");
  for (let i = 0; i < tabs.length; i++) {
    const tabId = tabs[i].id;
    const pres = tabs[i].getElementsByTagName("pre");
    for (let j = 0; j < pres.length; j++) {
      const preText = pres[j].textContent;
      const matches = findAllMatches(preText, input);
      matches.forEach(match => {
        searchResults.push({
          tabId,
          preIndex: j,
          ...match
        });
      });
    }
  }
  
  highlightCurrentMatch();
  updateSearchCount(searchResults.length, currentSearchIndex);
}

function updateSearchCount(total, current) {
  const countElement = document.getElementById("searchCount");
  if (total === 0) {
    countElement.textContent = "æœªæ‰¾åˆ°åŒ¹é…é¡¹";
    document.getElementById("prevMatch").disabled = true;
    document.getElementById("nextMatch").disabled = true;
  } else {
    countElement.textContent = `${current + 1}/${total}`;
    document.getElementById("prevMatch").disabled = current <= 0;
    document.getElementById("nextMatch").disabled = current >= total - 1;
  }
}

function navigateSearch(direction) {
  if (searchResults.length === 0) return;
  
  currentSearchIndex += direction;
  if (currentSearchIndex < 0) currentSearchIndex = searchResults.length - 1;
  if (currentSearchIndex >= searchResults.length) currentSearchIndex = 0;
  
  highlightCurrentMatch();
  updateSearchCount(searchResults.length, currentSearchIndex);
}

function highlightCurrentMatch() {
  // æ¸…é™¤æ‰€æœ‰é«˜äº®
  const tabs = document.getElementsByClassName("tabcontent");
  for (let i = 0; i < tabs.length; i++) {
    const pres = tabs[i].getElementsByTagName("pre");
    for (let j = 0; j < pres.length; j++) {
      let html = pres[j].innerHTML.replace(/<span class="mark.*?">(.*?)<\/span>/g, "$1");
      pres[j].innerHTML = html;
    }
  }
  
  if (searchResults.length === 0 || currentSearchIndex === -1) return;
  
  const currentMatch = searchResults[currentSearchIndex];
  
  // åˆ‡æ¢åˆ°å¯¹åº”çš„æ ‡ç­¾é¡µ
  const tabButton = document.querySelector(`button[onclick="openTab(event, '${currentMatch.tabId}')"]`);
  if (tabButton) {
    tabButton.click();
  }
  
  // é«˜äº®æ‰€æœ‰åŒ¹é…é¡¹ï¼Œå½“å‰åŒ¹é…é¡¹ç‰¹æ®Šé«˜äº®
  const searchTerm = document.getElementById("searchInput").value;
  const regex = new RegExp(`(${searchTerm})`, 'gi');
  const targetPre = document.getElementById(currentMatch.tabId)
    .getElementsByTagName("pre")[currentMatch.preIndex];
  
  targetPre.innerHTML = targetPre.textContent.replace(regex, (match, p1, offset) => {
    const isCurrentMatch = offset === currentMatch.index;
    return `<span class="mark${isCurrentMatch ? ' current' : ''}">${match}</span>`;
  });
  
  // æ‰¾åˆ°å½“å‰åŒ¹é…é¡¹çš„å…ƒç´ 
  const currentElement = targetPre.querySelector('.mark.current');
  if (currentElement) {
    // è·å–çˆ¶çº§detailså…ƒç´ 
    const detailsElement = targetPre.closest('details');
    if (detailsElement && !detailsElement.open) {
      detailsElement.open = true;
    }
    
    // è®¡ç®—æ»šåŠ¨ä½ç½®
    const contentContainer = document.querySelector('.content-container');
    const elementRect = currentElement.getBoundingClientRect();
    const containerRect = contentContainer.getBoundingClientRect();
    
    // æ£€æŸ¥å…ƒç´ æ˜¯å¦åœ¨è§†å›¾ä¸­
    const isInView = (
      elementRect.top >= containerRect.top &&
      elementRect.bottom <= containerRect.bottom
    );
    
    if (!isInView) {
      // è®¡ç®—ç†æƒ³çš„æ»šåŠ¨ä½ç½®ï¼ˆå°†åŒ¹é…é¡¹æ”¾åœ¨å®¹å™¨ä¸­é—´ï¼‰
      const elementTop = elementRect.top + contentContainer.scrollTop - containerRect.top;
      const containerMiddle = containerRect.height / 2;
      const scrollTo = elementTop - containerMiddle + elementRect.height / 2;
      
      // å¹³æ»‘æ»šåŠ¨åˆ°ç›®æ ‡ä½ç½®
      contentContainer.scrollTo({
        top: scrollTo,
        behavior: 'smooth'
      });
    }
    
    // æ·»åŠ é—ªçƒåŠ¨ç”»ä»¥çªå‡ºæ˜¾ç¤ºå½“å‰åŒ¹é…é¡¹
    currentElement.style.animation = 'none';
    currentElement.offsetHeight; // è§¦å‘é‡ç»˜
    currentElement.style.animation = 'highlight-pulse 1s';
  }
}

// æ·»åŠ è§„åˆ™å¼•æ“APIè°ƒç”¨
async function analyzeReport(data) {
  try {
    // ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè‡ªåŠ¨é€‚é…å½“å‰åŸŸåå’Œç«¯å£
    const response = await fetch('/analyze', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const results = await response.json();
    alertResults = results;
    displayAlerts();
  } catch (error) {
    console.error('è§„åˆ™åˆ†æå¤±è´¥:', error);
    // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°åˆ†æ
    performLocalAnalysis(data);
  }
}

// æœ¬åœ°åˆ†æåŠŸèƒ½ï¼ˆå½“APIä¸å¯ç”¨æ—¶ï¼‰
function performLocalAnalysis(data) {
  const localResults = {
    high: [],
    medium: [],
    low: []
  };
  
  // æ£€æŸ¥UIDä¸º0çš„ç”¨æˆ·
  if (data.backdoor && data.backdoor['UIDä¸º0çš„érootç”¨æˆ·']) {
    const uid0Content = data.backdoor['UIDä¸º0çš„érootç”¨æˆ·'];
    if (uid0Content.includes('å¯ç–‘UID 0ç”¨æˆ·') || uid0Content.match(/^(?!root)/m)) {
      localResults.high.push({
        rule_id: 'LOCAL_001',
        section: 'backdoor',
        subsection: 'UIDä¸º0çš„érootç”¨æˆ·',
        description: 'å‘ç°å¯ç–‘çš„UIDä¸º0ç”¨æˆ·',
        severity: 'high',
        recommendation: 'ç«‹å³ä¸è¿ç»´å’Œå¼€å‘äººå‘˜ç¡®è®¤è¿™äº›ç”¨æˆ·çš„åˆæ³•æ€§ï¼Œå¦‚æ— æ³•ç¡®è®¤åº”ç«‹å³ç¦ç”¨'
      });
    }
  }
  
  // æ£€æŸ¥å¯ç–‘è¿›ç¨‹
  if (data.process && data.process['å¯ç–‘è„šæœ¬è¿›ç¨‹']) {
    const processes = data.process['å¯ç–‘è„šæœ¬è¿›ç¨‹'].split('\n').filter(p => p.trim());
    if (processes.length > 10) {
      localResults.medium.push({
        rule_id: 'LOCAL_002',
        section: 'process',
        subsection: 'å¯ç–‘è„šæœ¬è¿›ç¨‹',
        description: `å‘ç°${processes.length}ä¸ªå¯ç–‘è„šæœ¬è¿›ç¨‹ï¼Œæ•°é‡å¼‚å¸¸`,
        severity: 'medium',
        recommendation: 'æ£€æŸ¥è¿™äº›è¿›ç¨‹çš„åˆæ³•æ€§ï¼Œç¡®è®¤å…¶ä¸šåŠ¡å¿…è¦æ€§'
      });
    }
  }
  
  // æ£€æŸ¥ç™»å½•å¤±è´¥
  if (data.user && data.user['ç™»å½•å¤±è´¥è®°å½•']) {
    const failedLogins = data.user['ç™»å½•å¤±è´¥è®°å½•'];
    const failCount = (failedLogins.match(/Failed password/g) || []).length;
    if (failCount > 50) {
      localResults.medium.push({
        rule_id: 'LOCAL_003',
        section: 'user',
        subsection: 'ç™»å½•å¤±è´¥è®°å½•',
        description: `ç™»å½•å¤±è´¥æ¬¡æ•°(${failCount})å¼‚å¸¸ï¼Œå¯èƒ½å­˜åœ¨æš´åŠ›ç ´è§£æ”»å‡»`,
        severity: 'medium',
        recommendation: 'æ£€æŸ¥ç™»å½•æ—¥å¿—ï¼ŒåŠ å¼ºå¯†ç ç­–ç•¥å’Œè®¿é—®æ§åˆ¶'
      });
    }
  }
  
  alertResults = localResults;
  displayAlerts();
  
  // æ˜¾ç¤ºæœ¬åœ°åˆ†ææç¤º
  const container = document.getElementById('alertContainer');
  const localNotice = document.createElement('div');
  localNotice.style.cssText = 'background: #e3f2fd; padding: 10px; margin-bottom: 15px; border-radius: 5px; font-size: 12px; color: #1565c0;';
  localNotice.innerHTML = 'ğŸ“ å½“å‰ä½¿ç”¨æœ¬åœ°åˆ†ææ¨¡å¼ï¼ŒåŠŸèƒ½æœ‰é™ã€‚å»ºè®®å¯åŠ¨å®Œæ•´çš„è§„åˆ™å¼•æ“æœåŠ¡è·å¾—æ›´å‡†ç¡®çš„åˆ†æç»“æœã€‚';
  container.insertBefore(localNotice, container.firstChild);
}

// ä¿®æ”¹renderTabså‡½æ•°
function renderTabs(data) {
  analysisData = data;
  
  // ç”Ÿæˆç»Ÿè®¡æ€»è§ˆæ•°æ®
  const summaryData = generateSummaryContent(data);
  data.summary = summaryData;
  
  const tabBtnHtml = gTabs.map((k, i) => 
    `<button class="tablinks" onclick="openTab(event, '${k}')">${TAB_TITLES[k]}</button>`
  ).join("");
  document.getElementById("tabBtns").innerHTML = tabBtnHtml;

  const tabContentHtml = gTabs.map(k => {
    const subTitles = SUB_TAB_TITLES[k];
    const subContent = subTitles.map(title => {
      let content = "";
      if (title === 'ğŸ“š æ’æŸ¥æ•™ç¨‹') {
        // æ˜¾ç¤ºæ•™ç¨‹å†…å®¹
        content = generateTutorial(k);
        return `<details open><summary>${title}</summary><div style="padding: 10px;">${content}</div></details>`;
      } else {
        // æ˜¾ç¤ºå®é™…æ•°æ®
        content = data[k] && data[k][title] ? data[k][title] : "";
        return `<details open><summary>${title}</summary><pre>${escapeHtml(content)}</pre></details>`;
      }
    }).join("");
    return `<div id="${k}" class="tabcontent">${subContent}</div>`;
  }).join("");
  document.getElementById("tabContents").innerHTML = tabContentHtml;

  // æ˜¾ç¤ºç»Ÿè®¡é¢æ¿
  displayStatsPanel();
  
  if (gTabs.length) {
    setTimeout(() => document.getElementsByClassName("tablinks")[0].click(), 100);
  }
  
  // è°ƒç”¨è§„åˆ™å¼•æ“APIè¿›è¡Œåˆ†æ
  analyzeReport(data);
}

// æ˜¾ç¤ºç»Ÿè®¡é¢æ¿
function displayStatsPanel() {
  const stats = systemStats;
  const statsHtml = `
    <div class="stats-panel">
      <h3>ğŸ“Š ç³»ç»Ÿå®‰å…¨çŠ¶å†µæ€»è§ˆ</h3>
      <div class="risk-level risk-${stats.risk_level.toLowerCase()}">
        é£é™©ç­‰çº§: ${stats.risk_level} (è¯„åˆ†: ${stats.risk_score})
      </div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number">${stats.total_users}</div>
          <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
        </div>
        <div class="stat-item">
          <div class="stat-number ${stats.uid0_users > 0 ? 'risk-high' : ''}">${stats.uid0_users}</div>
          <div class="stat-label">å¼‚å¸¸é«˜æƒé™ç”¨æˆ·</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">${stats.listening_ports}</div>
          <div class="stat-label">ç›‘å¬ç«¯å£</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">${stats.suspicious_processes}</div>
          <div class="stat-label">å¯ç–‘è¿›ç¨‹</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">${stats.suid_files}</div>
          <div class="stat-label">SUIDæ–‡ä»¶</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">${stats.failed_logins}</div>
          <div class="stat-label">ç™»å½•å¤±è´¥</div>
        </div>
      </div>
    </div>
  `;
  
  // åœ¨å†…å®¹åŒºåŸŸé¡¶éƒ¨æ’å…¥ç»Ÿè®¡é¢æ¿
  const contentContainer = document.querySelector('.content-container');
  const existingStats = contentContainer.querySelector('.stats-panel');
  if (existingStats) {
    existingStats.remove();
  }
  contentContainer.insertAdjacentHTML('afterbegin', statsHtml);
}

function escapeHtml(str) {
  if (!str) return "";
  return str.replace(/[&<>]/g, c => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;" }[c]));
}

document.addEventListener("DOMContentLoaded", function() {
  document.getElementById("fileInput").addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const text = e.target.result;
        try {
          const data = JSON.parse(text);
          renderTabs(data);
        } catch (jsonError) {
          const data = parseTextReport(text);
          renderTabs(data);
        }
      } catch (err) {
        alert("è§£æå¤±è´¥ï¼š" + err.message);
      }
    };
    reader.readAsText(file);
  });
  
  // æ·»åŠ æœç´¢å¯¼èˆªäº‹ä»¶ç›‘å¬
  document.getElementById("prevMatch").addEventListener("click", () => navigateSearch(-1));
  document.getElementById("nextMatch").addEventListener("click", () => navigateSearch(1));
});

// æ·»åŠ ä¾§è¾¹æ æŠ˜å åŠŸèƒ½
function toggleSidebar() {
  const sidebar = document.querySelector('.sidebar');
  const button = document.querySelector('.collapse-button');
  if (sidebar.style.width === '0px') {
    sidebar.style.width = '350px';
    button.textContent = 'æ”¶èµ·å‘Šè­¦é¢æ¿ >';
  } else {
    sidebar.style.width = '0px';
    button.textContent = '< å±•å¼€å‘Šè­¦é¢æ¿';
  }
}

// æ·»åŠ æ˜¾ç¤ºå‘Šè­¦çš„å‡½æ•°
function displayAlerts() {
  const container = document.getElementById('alertContainer');
  const summary = document.getElementById('alertSummary');
  
  // æ¸…ç©ºç°æœ‰å†…å®¹
  container.innerHTML = '';
  summary.innerHTML = '';
  
  // æ˜¾ç¤ºå‘Šè­¦ç»Ÿè®¡
  const summaryHtml = `
    <div class="alert-badge high">
      <span>é«˜å±å‘Šè­¦</span>
      <span class="count">${alertResults.high.length}</span>
    </div>
    <div class="alert-badge medium">
      <span>ä¸­å±å‘Šè­¦</span>
      <span class="count">${alertResults.medium.length}</span>
    </div>
    <div class="alert-badge low">
      <span>ä½å±å‘Šè­¦</span>
      <span class="count">${alertResults.low.length}</span>
    </div>
  `;
  summary.innerHTML = summaryHtml;
  
  // æ˜¾ç¤ºå‘Šè­¦è¯¦æƒ…
  const alertsHtml = [
    ...alertResults.high.map(alert => `
      <div class="alert alert-high">
        <div>
          <strong>${alert.description}</strong>
          <div style="margin-top: 5px; font-size: 12px; color: #666;">
            è§„åˆ™ID: ${alert.rule_id} | æ¨¡å—: ${alert.section} | å­é¡¹: ${alert.subsection}
          </div>
          ${alert.findings ? `
            <div style="margin-top: 10px;">
              <strong>å‘ç°:</strong>
              <ul style="margin: 5px 0; padding-left: 20px;">
                ${alert.findings.map(finding => `
                  <li style="cursor: pointer;" onclick="scrollToPosition('${alert.section}', '${alert.subsection}', ${finding.start}, ${finding.end})">
                    ä½ç½®: ${finding.start}-${finding.end}, åŒ¹é…æ–‡æœ¬: "${finding.matched_text}"
                  </li>
                `).join('')}
              </ul>
            </div>
          ` : ''}
          ${alert.recommendation ? `
            <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
              <strong>å¤„ç½®å»ºè®®:</strong> ${alert.recommendation}
            </div>
          ` : ''}
        </div>
      </div>
    `),
    ...alertResults.medium.map(alert => `
      <div class="alert alert-medium">
        <div>
          <strong>${alert.description}</strong>
          <div style="margin-top: 5px; font-size: 12px; color: #666;">
            è§„åˆ™ID: ${alert.rule_id} | æ¨¡å—: ${alert.section} | å­é¡¹: ${alert.subsection}
          </div>
          ${alert.findings ? `
            <div style="margin-top: 10px;">
              <strong>å‘ç°:</strong>
              <ul style="margin: 5px 0; padding-left: 20px;">
                ${alert.findings.map(finding => `
                  <li style="cursor: pointer;" onclick="scrollToPosition('${alert.section}', '${alert.subsection}', ${finding.start}, ${finding.end})">
                    ä½ç½®: ${finding.start}-${finding.end}, åŒ¹é…æ–‡æœ¬: "${finding.matched_text}"
                  </li>
                `).join('')}
              </ul>
            </div>
          ` : ''}
          ${alert.recommendation ? `
            <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
              <strong>å¤„ç½®å»ºè®®:</strong> ${alert.recommendation}
            </div>
          ` : ''}
        </div>
      </div>
    `),
    ...alertResults.low.map(alert => `
      <div class="alert alert-low">
        <div>
          <strong>${alert.description}</strong>
          <div style="margin-top: 5px; font-size: 12px; color: #666;">
            è§„åˆ™ID: ${alert.rule_id} | æ¨¡å—: ${alert.section} | å­é¡¹: ${alert.subsection}
          </div>
          ${alert.findings ? `
            <div style="margin-top: 10px;">
              <strong>å‘ç°:</strong>
              <ul style="margin: 5px 0; padding-left: 20px;">
                ${alert.findings.map(finding => `
                  <li style="cursor: pointer;" onclick="scrollToPosition('${alert.section}', '${alert.subsection}', ${finding.start}, ${finding.end})">
                    ä½ç½®: ${finding.start}-${finding.end}, åŒ¹é…æ–‡æœ¬: "${finding.matched_text}"
                  </li>
                `).join('')}
              </ul>
            </div>
          ` : ''}
          ${alert.recommendation ? `
            <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
              <strong>å¤„ç½®å»ºè®®:</strong> ${alert.recommendation}
            </div>
          ` : ''}
        </div>
      </div>
    `)
  ].join('');
  
  container.innerHTML = alertsHtml;
}

function scrollToPosition(section, subsection, start, end) {
  // åˆ‡æ¢åˆ°å¯¹åº”çš„æ ‡ç­¾é¡µ
  const tabButton = document.querySelector(`button[onclick="openTab(event, '${section}')"]`);
  if (tabButton) {
    tabButton.click();
  }
  
  // æ‰¾åˆ°å¯¹åº”çš„è¯¦æƒ…å…ƒç´ å¹¶å±•å¼€
  setTimeout(() => {
    const tabContent = document.getElementById(section);
    if (tabContent) {
      const details = Array.from(tabContent.querySelectorAll('details')).find(d => 
        d.querySelector('summary').textContent.includes(subsection)
      );
      if (details) {
        details.open = true;
        details.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }
  }, 100);
}

</script>
</head>
<body>
  <div class="header">
    <h1>ğŸ›¡ï¸ Linux åº”æ€¥å“åº”æŠ¥å‘ŠæŸ¥çœ‹å™¨ (è¯¦ç»†ç‰ˆ)</h1>
    <div class="subtitle">ä¸“ä¸šåŒ–å®‰å…¨å¨èƒæ£€æµ‹ä¸åˆ†æç³»ç»Ÿ | è¯¦ç»†æ—¥å¿—åˆ†æ + æ”»å‡»æº¯æº + æŠ€æœ¯æ•™ç¨‹</div>
  </div>

  <div class="main-container">
    <div class="content-container">
      <div class="search-container">
        <input type="file" id="fileInput" accept=".txt,.json">
        <input type="text" id="searchInput" placeholder="æœç´¢æŠ¥å‘Šå†…å®¹..." onkeyup="searchTabs()">
        <div class="search-nav">
          <button id="prevMatch" onclick="navigateSearch(-1)" disabled>ä¸Šä¸€ä¸ª</button>
          <button id="nextMatch" onclick="navigateSearch(1)" disabled>ä¸‹ä¸€ä¸ª</button>
          <span id="searchCount">è¾“å…¥å…³é”®è¯æœç´¢</span>
        </div>
      </div>

      <div class="tabs" id="tabBtns">
        <!-- æ ‡ç­¾æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>

      <div id="tabContents">
        <!-- æ ‡ç­¾å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <div class="sidebar">
      <div class="sidebar-header">
        <h3>ğŸš¨ å®‰å…¨å‘Šè­¦é¢æ¿</h3>
        <button class="collapse-button" onclick="toggleSidebar()">æ”¶èµ·å‘Šè­¦é¢æ¿ ></button>
        <div id="alertSummary" class="alert-summary">
          <!-- å‘Šè­¦ç»Ÿè®¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
      </div>
      <div id="alertContainer" class="alert-container">
        <div style="text-align: center; padding: 40px; color: #666;">
          <p>ğŸ“ è¯·é€‰æ‹©æŠ¥å‘Šæ–‡ä»¶å¼€å§‹åˆ†æ</p>
          <p style="font-size: 0.9em; margin-top: 10px;">æ”¯æŒ .txt å’Œ .json æ ¼å¼</p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>

